<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.101.0" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Typo in Hyman non-negative constraint - 28 years later &middot; Chase the Devil</title>
  <meta name="description" content="" />

  
  <link type="text/css" rel="stylesheet" href="https://chasethedevil.github.io/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://chasethedevil.github.io/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://chasethedevil.github.io/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://chasethedevil.github.io/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">
<link href="https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&display=swap" rel="stylesheet">
 <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

</head>

  <body class=" ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://chasethedevil.github.io/"><h1 style="font-family: 'UnifrakturMaguntia', cursive;font-weight: normal;">Chase the Devil</h1></a>
      <p class="lead">
       A personal, independent, technical blog 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://chasethedevil.github.io/">Blog</a> </li>
        <li><a href="/about/"> About </a></li><li><a href="/post/"> Posts </a></li><li><a href="/tags/"> Tags </a></li>
      </ul>

        <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <script type="text/javascript">document.write("<a href=\"mail" + "to:" + new Array("fabien","2ipi.com").join("@") + "?subject=your%20blog\">" + '<i class="fa fa-envelope fa-3x"></i>' + "</" + "a>");</script>
      
      
      
      
      
      
      <a href="https://twitter.com/logos01"><i class="fa fa-twitter-square fa-3x"></i></a>
      
      <a href="https://chasethedevil.github.io/index.xml" type="application/rss+xml"><i class="fa fa-rss-square fa-3x"></i></a>
      </li>
    </ul>
 </nav>

    <p>&copy; 2023. All rights reserved. </p>
  </div>
</aside>

    <main class="content container">
    <div class="post">
  <h1>Typo in Hyman non-negative constraint - 28 years later</h1>
  <time datetime=2017-05-23T23:56:42&#43;0100 class="post-date">Tue, May 23, 2017</time>
  <p>In their paper <a href="http://www.ams.org/journals/mcom/1989-52-186/S0025-5718-1989-0962209-1/S0025-5718-1989-0962209-1.pdf">&ldquo;Nonnegativity-, Monotonicity-, or Convexity-Preserving Cubic and Quintic Hermite Interpolation&rdquo;</a>, Dougherty, Edelman and Hyman present a simple filter on the first derivatives to maintain positivity of a cubic spline interpolant.</p>
<p>Unfortunately, in their main formula for non-negativity, they made a typo: the equation (3.3) is not consistent with the equation (3.1): the  \( \Delta x_{i-1/2} \)  is interverted with  \( \Delta x_{i+1/2} \).</p>
<p>It was not obvious to find out which equation was wrong since there is no proof in the paper. Fortunately, the proof is in the reference paper <a href="http://epubs.siam.org/doi/abs/10.1137/0722023">&ldquo;Monotone piecewise bicubic interpolation&rdquo;</a> from Carlson and Fritsch and it is clear then that equation (3.1) is the correct one.</p>
<p>Here is a counter example for equation (3.3) for a Hermite cubic spline with natural boundary conditions
 

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span>	x <span style="color: #666666">:=</span> []<span style="color: #902000">float64</span>{<span style="color: #666666">-</span><span style="color: #40a070">2.427680355823974</span>, <span style="color: #666666">-</span><span style="color: #40a070">2.3481443181227126</span>, <span style="color: #666666">-</span><span style="color: #40a070">2.268608280421452</span>, <span style="color: #666666">-</span><span style="color: #40a070">2.189072242720191</span>, <span style="color: #666666">-</span><span style="color: #40a070">2.1095362050189297</span>, <span style="color: #666666">-</span><span style="color: #40a070">2.0300001673176684</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.9504641296164076</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.8709280919151465</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.7913920542138855</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.7118560165126244</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.6323199788113634</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.5527839411101023</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.4732479034088413</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.3937118657075802</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.3141758280063192</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.234639790305058</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.155103752603797</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.075567714902536</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.996031677201275</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.9164956395000139</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.8369596017987528</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.7574235640974918</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.6778875263962307</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.5983514886949697</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.5188154509937086</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.4392794132924476</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.3597433755911865</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.28020733788992525</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.20067130018866441</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.12113526248740358</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.04159922478614231</span>, <span style="color: #40a070">0.03793681291511897</span>, <span style="color: #40a070">0.1174728506163798</span>, <span style="color: #40a070">0.19700888831764063</span>, <span style="color: #40a070">0.2765449260189019</span>, <span style="color: #40a070">0.3560809637201632</span>, <span style="color: #40a070">0.435617001421424</span>, <span style="color: #40a070">0.5151530391226848</span>, <span style="color: #40a070">0.5946890768239461</span>, <span style="color: #40a070">0.6742251145252074</span>, <span style="color: #40a070">0.7537611522264682</span>}
y <span style="color: #666666">:=</span> []<span style="color: #902000">float64</span>{<span style="color: #40a070">0.22303659708933243</span>, <span style="color: #40a070">0.22655584607177778</span>, <span style="color: #40a070">0.16305913092318047</span>, <span style="color: #40a070">0.10448859033589929</span>, <span style="color: #40a070">0.16002349837315494</span>, <span style="color: #40a070">0.15632461201014838</span>, <span style="color: #40a070">0.20216975718723287</span>, <span style="color: #40a070">0.15780097999496998</span>, <span style="color: #40a070">0.1293436080647528</span>, <span style="color: #40a070">0.13101037880853464</span>, <span style="color: #40a070">0.13496819587884762</span>, <span style="color: #40a070">0.1241082758487616</span>, <span style="color: #40a070">0.13677319399415233</span>, <span style="color: #40a070">0.11493379360854317</span>, <span style="color: #40a070">0.10181073092072719</span>, <span style="color: #40a070">0.10390553149978735</span>, <span style="color: #40a070">0.09705141597989163</span>, <span style="color: #40a070">0.09469310717587004</span>, <span style="color: #40a070">0.09397968424452849</span>, <span style="color: #40a070">0.08115526370674754</span>, <span style="color: #40a070">0.07021707117654993</span>, <span style="color: #40a070">0.07896827656600293</span>, <span style="color: #40a070">0.0733165278111029</span>, <span style="color: #40a070">0.06626131630031683</span>, <span style="color: #40a070">0.06036157053511007</span>, <span style="color: #40a070">0.05598416466538939</span>, <span style="color: #40a070">0.049613807117723785</span>, <span style="color: #40a070">0.04821691404672292</span>, <span style="color: #40a070">0.04274830629369516</span>, <span style="color: #40a070">0.04053002586588819</span>, <span style="color: #40a070">0.03690680495068648</span>, <span style="color: #40a070">0.03232925805830648</span>, <span style="color: #40a070">0.02686034599416645</span>, <span style="color: #40a070">0.02152456554605186</span>, <span style="color: #40a070">0.01281016667726421</span>, <span style="color: #40a070">0.005672278716525797</span>, <span style="color: #40a070">0.0021938540693167367</span>, <span style="color: #40a070">0.0015582304062002356</span>, <span style="color: #40a070">0.0002050615897307207</span>, <span style="color: #40a070">3.232807285235909e-07</span>, <span style="color: #40a070">4.059553937573009e-06</span>}
z <span style="color: #666666">:=</span> <span style="color: #40a070">0.7410184269884271</span>
</pre></div>

</p>
<p>In the above example, even though the step size \(\Delta x\) is constant, the error is visible at the last node since then only one inequation apply, and it will be different with the typo.</p>
<p>It is quite annoying to stumble upon such typos, especially when the equations stem from a derived correct paper. We wonder then where are the other typos in the paper and our trust in the equations is greatly weakened. Unfortunately, such mistakes happen to everybody, including myself, and they are rarely caught by reviewers.</p>

</div>

<h2>Comments</h2>
<div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "chasethedevil" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </main>

    
      
    
  </body>
</html>
