<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.83.1" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Chase the Devil</title>
  <meta name="description" content="A personal, independent, technical blog" />

  
  <link type="text/css" rel="stylesheet" href="https://chasethedevil.github.io/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://chasethedevil.github.io/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://chasethedevil.github.io/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://chasethedevil.github.io/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">
<link href="https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&display=swap" rel="stylesheet">
 <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="https://chasethedevil.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Chase the Devil" />
  <script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

</head>

  <body class=" ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://chasethedevil.github.io/"><h1 style="font-family: 'UnifrakturMaguntia', cursive;font-weight: normal;">Chase the Devil</h1></a>
      <p class="lead">
       A personal, independent, technical blog 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://chasethedevil.github.io/">Blog</a> </li>
        <li><a href="/about/"> About </a></li><li><a href="/post/"> Posts </a></li>
      </ul>

        <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <script type="text/javascript">document.write("<a href=\"mail" + "to:" + new Array("fabien","2ipi.com").join("@") + "?subject=your%20blog\">" + '<i class="fa fa-envelope fa-3x"></i>' + "</" + "a>");</script>
      
      
      
      
      
      
      <a href="https://twitter.com/logos01"><i class="fa fa-twitter-square fa-3x"></i></a>
      
      <a href="https://chasethedevil.github.io/index.xml" type="application/rss+xml"><i class="fa fa-rss-square fa-3x"></i></a>
      </li>
    </ul>
 </nav>

    <p>&copy; 2021. All rights reserved. </p>
  </div>
</aside>

    <main class="content container">
    <div class="posts">
<article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/diffusion-limited-aggregation-applet/">Diffusion Limited Aggregation Applet</a>
  </h1>
  <time datetime="2010-06-09T14:05:00Z" class="post-date">Wed, Jun 9, 2010</time>
  <p>Yes, I wrote an applet. I know it is very 1990s but, amazingly, it still does the job quite well. Ok, next time I should really use Flash to do this.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The Applet simulates <!-- raw HTML omitted -->Diffusion Limited Aggregation<!-- raw HTML omitted --> as described in Chaos And Fractals from Peitgen, Juergens, and Saupe. It represents ions randomly wandering around (in a Brownian motion) until they are caught by an attractive force in electrochemical deposition experiment. This kind of phenomenon occurs at all scales, for example it happens in the distribution of galaxies. You can play around with the applet at <!-- raw HTML omitted --><a href="http://31416.appspot.com/dla.vm">http://31416.appspot.com/dla.vm</a><!-- raw HTML omitted --></p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/java-3d-surface/">Java &amp; 3D Surface</a>
  </h1>
  <time datetime="2009-12-18T16:07:00Z" class="post-date">Fri, Dec 18, 2009</time>
  <p>I have been looking all around the web for a Java library that can draw a simple 3D surface. And I did not find any. Most charting library, including the well known JFreeChart, can only draw 2D charts. <!-- raw HTML omitted --><!-- raw HTML omitted -->I am quite shocked that something that has been in Excel for 15 years is still not available in Java. And it&rsquo;s not easy to make your own.</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/double-is-fine/">double[][] Is Fine</a>
  </h1>
  <time datetime="2009-11-26T14:51:00Z" class="post-date">Thu, Nov 26, 2009</time>
  <p>In my previous post, I suggest that keeping a double[] performs better than keeping a double[][] if you do matrix multiplications and other operations.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->This is actually not true. I benchmarked 3 libraries, Colt (uses double[]), Apache Commons Math (uses double[][]) and Jama (uses double[][] cleverly). At first it looks like Jama has a similar performance as Colt (they avoid [][] slow access by a clever algorithm). But once hotspot hits, the difference is crazy and Jama becomes the fastest (Far ahead).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->JDK 1.6.0 Linux 1000x1000 matrix multiplication on Intel Q6600<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->loop index<!-- raw HTML omitted --><!-- raw HTML omitted -->Colt<!-- raw HTML omitted --><!-- raw HTML omitted -->Commons Math<!-- raw HTML omitted --><!-- raw HTML omitted -->Jama<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->1<!-- raw HTML omitted --><!-- raw HTML omitted -->11.880748<!-- raw HTML omitted --><!-- raw HTML omitted -->24.455125<!-- raw HTML omitted --><!-- raw HTML omitted -->9.828977<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->2<!-- raw HTML omitted --><!-- raw HTML omitted -->11.874975<!-- raw HTML omitted --><!-- raw HTML omitted -->24.265102<!-- raw HTML omitted --><!-- raw HTML omitted -->9.848916<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->3<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->9.772616<!-- raw HTML omitted --><!-- raw HTML omitted -->14.374153<!-- raw HTML omitted --><!-- raw HTML omitted -->9.826572<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->4<!-- raw HTML omitted --><!-- raw HTML omitted -->9.759679<!-- raw HTML omitted --><!-- raw HTML omitted -->14.368105<!-- raw HTML omitted --><!-- raw HTML omitted -->2.655915<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->5<!-- raw HTML omitted --><!-- raw HTML omitted -->9.799622<!-- raw HTML omitted --><!-- raw HTML omitted -->15.238928<!-- raw HTML omitted --><!-- raw HTML omitted -->2.649129<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->6<!-- raw HTML omitted --><!-- raw HTML omitted -->9.780556<!-- raw HTML omitted --><!-- raw HTML omitted -->14.741863<!-- raw HTML omitted --><!-- raw HTML omitted -->2.668104<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->7<!-- raw HTML omitted --><!-- raw HTML omitted -->9.72831<!-- raw HTML omitted --><!-- raw HTML omitted -->15.509909<!-- raw HTML omitted --><!-- raw HTML omitted -->2.646811<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->8<!-- raw HTML omitted --><!-- raw HTML omitted -->9.79838<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->15.724348<!-- raw HTML omitted --><!-- raw HTML omitted -->2.646069<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->9<!-- raw HTML omitted --><!-- raw HTML omitted -->9.726143<!-- raw HTML omitted --><!-- raw HTML omitted -->15.988762<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->2.646052<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->10<!-- raw HTML omitted --><!-- raw HTML omitted -->9.784505<!-- raw HTML omitted --><!-- raw HTML omitted -->15.121782<!-- raw HTML omitted --><!-- raw HTML omitted -->2.644572<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->We don&rsquo;t include matrix construction time, and fetching the result. Only the multiplication is taken into account.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The difference is less pronounced on smaller matrices, but still there. Jama looks very good in this simple test case. In more real scenarios, the difference is not so obvious. For example Commons Math SVD is faster than Jama one.</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/the-pain-of-java-matrix-libraries/">The Pain of Java Matrix Libraries</a>
  </h1>
  <time datetime="2009-11-26T09:17:00Z" class="post-date">Thu, Nov 26, 2009</time>
  <p>Looking for a good Java Matrix (and actually also math) library, I was a bit surprised to find out there does not seem to be any really serious one still maintained.<!-- raw HTML omitted --><!-- raw HTML omitted -->Sure, there is <!-- raw HTML omitted -->Apache Commons Math<!-- raw HTML omitted -->, but it is still changing a lot, and it is not very performance optimized yet, while it has been active for several years already. There is also Java3D, it does Matrix through GMatrix, but not much linear algebra and if you look at their implementation, it is very basic, not performance oriented.<!-- raw HTML omitted --><!-- raw HTML omitted -->The other candidates seem to be 1-man projects that can disappear any other day (some of them look quite good like ojalgo, most of them are not interesting). Then you also have the serious but not maintained anymore <!-- raw HTML omitted -->Cern Colt<!-- raw HTML omitted --> library.<!-- raw HTML omitted --><!-- raw HTML omitted -->Compared to C/C++, the Java world is worrying if you want to do maths.<!-- raw HTML omitted --><!-- raw HTML omitted -->In those libraries, a dense matrix of double can be implemented two ways:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->by maintaining internally a double[][]. Usually those libraries allow for not copying the array, so it can be neat if your interfaces have this kind of arrays.<!-- raw HTML omitted --><!-- raw HTML omitted -->by maintaining internally a double[]. The reason is for performance, but then each time you build a matrix from a double[][], an expensive copy will happen. So you need to use the Matrix object in your interfaces instead of double[][].<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->This is a pain because you can be very quickly stuck in one or the other Matrix library. A &ldquo;solution&rdquo; is to have your own interface, but that is a pain to write. There is <!-- raw HTML omitted -->UJMP<!-- raw HTML omitted -->, but it can hide some important methods (like transpose &amp; multiply in one go from Colt or the ability to reuse an existing matrix in various operations to avoid allocating new memory), it is a students project (like parallel colt), but if it was a standard, it could be much more interesting.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->In summary it does really look like scientific people, universities don&rsquo;t use Java for computation otherwise Colt surely would have been maintained.<!-- raw HTML omitted --><!-- raw HTML omitted --></p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/java-calendar-is-broken-on-jvm-upgrade/">Java Calendar Is Broken On JVM Upgrade</a>
  </h1>
  <time datetime="2009-08-19T13:47:00Z" class="post-date">Wed, Aug 19, 2009</time>
  <p>We ran into an interesting issue with TimeZone and Dates. If you print the same date on different JVMs, it might show a different printed date.<!-- raw HTML omitted --><!-- raw HTML omitted -->The reason behind this is the daylight saving time conventions. An old JVM won&rsquo;t necessarily have the same daylight saving time for a given TimeZone than a latest JVM, and therefore will interpret the date differently.<!-- raw HTML omitted --><!-- raw HTML omitted -->Here is the output of a very simple program on 2 different JVMs. The number is the long number used to represent the date. I only use SimpleDateFormat with different TimeZone:<!-- raw HTML omitted --><!-- raw HTML omitted -->JVM 1.5.0_12<!-- raw HTML omitted -->loading date=Sat Jul 18 06:59:36 CEST 2009, number=1247893176505<!-- raw HTML omitted -->using formatter in EST: <!-- raw HTML omitted -->7/17/09 11:59 PM<!-- raw HTML omitted --><!-- raw HTML omitted -->using formatter in Asia/Singapore: 7/18/09 12:59 PM<!-- raw HTML omitted --><!-- raw HTML omitted -->JVM 1.5.0_20<!-- raw HTML omitted -->loading date=Sat Jul 18 06:59:36 CEST 2009, number=1247893176505<!-- raw HTML omitted -->using formatter in EST: <!-- raw HTML omitted -->7/18/09 12:59 AM<!-- raw HTML omitted --><!-- raw HTML omitted -->using formatter in Asia/Singapore: 7/18/09 12:59 PM<!-- raw HTML omitted --><!-- raw HTML omitted -->The source code:<!-- raw HTML omitted --><!-- raw HTML omitted -->public class DateBug {       <!-- raw HTML omitted -->   <!-- raw HTML omitted -->    private static String FILE_NAME = &ldquo;datebug.txt&rdquo;;<!-- raw HTML omitted -->   <!-- raw HTML omitted -->    public static void load() throws IOException {<!-- raw HTML omitted -->        FileReader fr = new FileReader(FILE_NAME);<!-- raw HTML omitted -->        BufferedReader br = new BufferedReader(fr);<!-- raw HTML omitted -->        String l = br.readLine();<!-- raw HTML omitted -->        br.close();<!-- raw HTML omitted -->        long time = new Long(l);<!-- raw HTML omitted -->        Date d = new Date(time);<!-- raw HTML omitted -->        System.out.println(&ldquo;loading date=&quot;+d+&rdquo;, number=&quot;+d.getTime());<!-- raw HTML omitted -->        SimpleDateFormat formatter = new SimpleDateFormat();<!-- raw HTML omitted -->        formatter.setTimeZone(TimeZone.getTimeZone(&ldquo;EST&rdquo;));<!-- raw HTML omitted -->        System.out.println(&ldquo;using formatter in EST: &ldquo;+formatter.format(d));<!-- raw HTML omitted -->        formatter.setTimeZone(TimeZone.getTimeZone(&ldquo;Asia/Singapore&rdquo;));<!-- raw HTML omitted -->        System.out.println(&ldquo;using formatter in Asia/Singapore: &ldquo;+formatter.format(d));<!-- raw HTML omitted -->    }<!-- raw HTML omitted -->   <!-- raw HTML omitted -->    public static void saveNew() throws IOException {<!-- raw HTML omitted -->        Calendar c = Calendar.getInstance(TimeZone.getTimeZone(&ldquo;EST&rdquo;));<!-- raw HTML omitted -->        c.set(2009, 06, 17, 23, 59);<!-- raw HTML omitted -->        Date d = c.getTime();<!-- raw HTML omitted -->        System.out.println(&ldquo;saving date=&quot;+d+&rdquo;, number=&quot;+d.getTime());<!-- raw HTML omitted -->        SimpleDateFormat formatter = new SimpleDateFormat();<!-- raw HTML omitted -->        formatter.setTimeZone(TimeZone.getTimeZone(&ldquo;EST&rdquo;));<!-- raw HTML omitted -->        System.out.println(&ldquo;using formatter in EST: &ldquo;+formatter.format(d));<!-- raw HTML omitted -->        formatter.setTimeZone(TimeZone.getTimeZone(&ldquo;Asia/Singapore&rdquo;));<!-- raw HTML omitted -->        System.out.println(&ldquo;using formatter in Asia/Singapore: &ldquo;+formatter.format(d));<!-- raw HTML omitted -->       <!-- raw HTML omitted -->        FileWriter fw = new FileWriter(FILE_NAME);<!-- raw HTML omitted -->        PrintWriter pw = new PrintWriter(fw);<!-- raw HTML omitted -->        pw.println(d.getTime());<!-- raw HTML omitted -->        pw.close();<!-- raw HTML omitted -->    }<!-- raw HTML omitted -->   <!-- raw HTML omitted -->    public static void main(String[] args) throws IOException {<!-- raw HTML omitted -->        System.out.println(&ldquo;JVM &ldquo;+System.getProperty(&ldquo;java.version&rdquo;));<!-- raw HTML omitted -->        if (args.length == 1) {<!-- raw HTML omitted -->            if (args[0].equals(&ldquo;save&rdquo;)) {<!-- raw HTML omitted -->                saveNew();<!-- raw HTML omitted -->            }<!-- raw HTML omitted -->        } else {<!-- raw HTML omitted -->            load();<!-- raw HTML omitted -->        }<!-- raw HTML omitted -->    }<!-- raw HTML omitted --><!-- raw HTML omitted -->What does this mean? This means that if you entered in a GUI in the first JVM a particular date &amp; time using EST time zone. This will change when you read back in the second JVM.<!-- raw HTML omitted -->This suggests that if you want to keep the same dates, you are better off saving in UTC where daylight saving time is not used and trick DateFormat. But I have to say this looks quite ugly.</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/implicit-finite-differences-method-for-pricing-barrier-option/">Implicit Finite Differences Method For Pricing Barrier Option</a>
  </h1>
  <time datetime="2009-08-17T12:04:00Z" class="post-date">Mon, Aug 17, 2009</time>
  <p><!-- raw HTML omitted -->&lt;img style=&ldquo;float:left; margin:0 10px 10px 0;cursor:pointer; cursor:hand;width: 320px; height: 74px;&rdquo; src=&ldquo;<a href="http://3.bp.blogspot.com/_9RyqGT46Fbk/Sokrd-84xhI/AAAAAAAAERE/-gs3_MMw0oo/s320/implicit_method_barrier_option_html_m531cf9ea.jpg%22">http://3.bp.blogspot.com/_9RyqGT46Fbk/Sokrd-84xhI/AAAAAAAAERE/-gs3_MMw0oo/s320/implicit_method_barrier_option_html_m531cf9ea.jpg&quot;</a> border=&ldquo;0&rdquo; alt=&ldquo;&ldquo;id=&ldquo;BLOGGER_PHOTO_ID_5370871824730605074&rdquo; /&gt;<!-- raw HTML omitted --><!-- raw HTML omitted -->While trying to price a simple knock down and out barrier option, I encountered several difficulties I did not expect with the implicit finite differences method. The explicit method has less issues with barrier options pricing. I will show here what the tricky parts are and why explicit seems simpler in this case.<!-- raw HTML omitted --><!-- raw HTML omitted -->The full article is <!-- raw HTML omitted -->here (pdf)<!-- raw HTML omitted --> or <!-- raw HTML omitted -->here (html)<!-- raw HTML omitted --> (the later is not very well formatted).<!-- raw HTML omitted --><!-- raw HTML omitted -->Algorithms used in this article can be found at <!-- raw HTML omitted --><a href="http://code.google.com/p/javamc/">http://code.google.com/p/javamc/</a><!-- raw HTML omitted --></p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/pulseaudio-nightmares-pure-alsa-to-the-rescue/">Pulseaudio Nightmares - Pure ALSA to the Rescue</a>
  </h1>
  <time datetime="2009-06-27T18:19:00Z" class="post-date">Sat, Jun 27, 2009</time>
  <p>In the latest stable Ubuntu (9.04), pulseaudio still does not work reliably on my hardware (intel HDA with digital SPDIF out). I upgraded to 9.10 and had even more problems. Sound always worked on boot, but often broke down after a while. And I could not find easy ways to make it work other than rebooting&hellip; Killing/restarting pulseaudio, looking at the processes using snd did not work.<!-- raw HTML omitted --><!-- raw HTML omitted -->One thing works wonderfully, pure ALSA. To have multilple apps sharing ALSA, I just use dmix. As I use digital out, there is no mixer, but ALSA can provide one through softvol. It works really well. ALSA is already not that simple to configure/setup properly, but with pulseaudio on top, welcome to your worst configuration nightmares.<!-- raw HTML omitted --><!-- raw HTML omitted -->Here is the .asoundrc I use:<!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted -->pcm.amix {<!-- raw HTML omitted -->   type dmix<!-- raw HTML omitted -->   ipc_key 50557<!-- raw HTML omitted -->   slave {<!-- raw HTML omitted -->       pcm &ldquo;hw:0,1&rdquo;<!-- raw HTML omitted -->       period_time 0<!-- raw HTML omitted -->       period_size 1024<!-- raw HTML omitted -->       buffer_size 8192<!-- raw HTML omitted -->   }<!-- raw HTML omitted -->   bindings {<!-- raw HTML omitted -->       0 0<!-- raw HTML omitted -->       1 1<!-- raw HTML omitted -->   }<!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted -->pcm.softvol {<!-- raw HTML omitted -->    type            softvol<!-- raw HTML omitted -->    slave {<!-- raw HTML omitted -->        pcm         &ldquo;amix&rdquo;      #redirect the output to dmix (instead of &ldquo;hw:0,0&rdquo;)<!-- raw HTML omitted -->    }<!-- raw HTML omitted -->    control {<!-- raw HTML omitted -->        name        &ldquo;PCM&rdquo;       #override the PCM slider to set the softvol volume level globally<!-- raw HTML omitted -->        card        0<!-- raw HTML omitted -->    }<!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->pcm.!default {<!-- raw HTML omitted -->    type            plug<!-- raw HTML omitted -->    slave.pcm       &ldquo;softvol&rdquo;   #make use of softvol<!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted --></p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/java-int-overflow-behavior/">Java int Overflow Behavior</a>
  </h1>
  <time datetime="2009-06-15T16:15:00Z" class="post-date">Mon, Jun 15, 2009</time>
  <p>A coworker recently asked me if there was a guaranteed behavior in the case of int overflow. He gave the specific example on:<!-- raw HTML omitted -->can we rely that int x = Integer.MAX_VALUE + 1 is the same for every JVM on any platform?<!-- raw HTML omitted --><!-- raw HTML omitted -->I thought the answer would be easy to find in the Java specifications document. But I was wrong. It is not clearly defined.<!-- raw HTML omitted --><!-- raw HTML omitted -->I found a trick that suggests this behavior is indeed standard and will stay the same, it is related to type casting. Java guarantees that the cast of a long just truncates the long to int precision. Therefore if<!-- raw HTML omitted -->long l = Integer.MAX_VALUE;<!-- raw HTML omitted -->l = l +1;<!-- raw HTML omitted -->x = (int)l;<!-- raw HTML omitted -->x has a guaranteed value.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="http://java.sun.com/docs/books/jls/third_edition/html/conversions.html">http://java.sun.com/docs/books/jls/third_edition/html/conversions.html</a><!-- raw HTML omitted --><!-- raw HTML omitted -->paragraph 5.1.3</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/static-fields-and-inheritance/">Static Fields and Inheritance</a>
  </h1>
  <time datetime="2009-06-15T16:02:00Z" class="post-date">Mon, Jun 15, 2009</time>
  <p>Someone asked me recently to find out the real reason why the code from this thread fails. This is a fairly bad code, and not even a very good way to point out the problem. But the question is nonetheless interesting.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->class<!-- raw HTML omitted --><!-- raw HTML omitted --> Toto <!-- raw HTML omitted --><!-- raw HTML omitted -->extends<!-- raw HTML omitted --><!-- raw HTML omitted --> TotoParent<!-- raw HTML omitted -->{<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted -->final<!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted -->static<!-- raw HTML omitted --><!-- raw HTML omitted --> Toto a = <!-- raw HTML omitted --><!-- raw HTML omitted -->new<!-- raw HTML omitted --><!-- raw HTML omitted --> Toto (<!-- raw HTML omitted -->&ldquo;a&rdquo;<!-- raw HTML omitted -->);<!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted -->public<!-- raw HTML omitted --><!-- raw HTML omitted --> Toto(String a)<!-- raw HTML omitted -->{<!-- raw HTML omitted --><!-- raw HTML omitted -->  <!-- raw HTML omitted --><!-- raw HTML omitted -->super<!-- raw HTML omitted --><!-- raw HTML omitted -->(a);<!-- raw HTML omitted --> <!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->import<!-- raw HTML omitted --><!-- raw HTML omitted --> java.util.ArrayList;<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->import<!-- raw HTML omitted --><!-- raw HTML omitted --> java.util.List;<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->public<!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted -->abstract<!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted -->class<!-- raw HTML omitted --><!-- raw HTML omitted --> TotoParent <!-- raw HTML omitted -->{<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted -->static<!-- raw HTML omitted --><!-- raw HTML omitted --> List<!-- raw HTML omitted --> list = <!-- raw HTML omitted --><!-- raw HTML omitted -->new<!-- raw HTML omitted --><!-- raw HTML omitted --> ArrayList<!-- raw HTML omitted -->();<!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted -->public<!-- raw HTML omitted --><!-- raw HTML omitted --> TotoParent(String a) <!-- raw HTML omitted -->{<!-- raw HTML omitted --><!-- raw HTML omitted -->  list.add(a);<!-- raw HTML omitted --> <!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted -->protected<!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted -->static<!-- raw HTML omitted --><!-- raw HTML omitted --> List<!-- raw HTML omitted --> get() <!-- raw HTML omitted -->{<!-- raw HTML omitted --><!-- raw HTML omitted -->  <!-- raw HTML omitted --><!-- raw HTML omitted -->return<!-- raw HTML omitted --><!-- raw HTML omitted --> list;<!-- raw HTML omitted -->  <!-- raw HTML omitted --> <!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->import<!-- raw HTML omitted --><!-- raw HTML omitted --> org.junit.Test;<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->import<!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted -->static<!-- raw HTML omitted --><!-- raw HTML omitted --> org.junit.Assert.*;<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->public<!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted -->class<!-- raw HTML omitted --><!-- raw HTML omitted --> TotoTest <!-- raw HTML omitted -->{<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> @Test<!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted -->public<!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted -->void<!-- raw HTML omitted --><!-- raw HTML omitted --> testGet()<!-- raw HTML omitted -->{<!-- raw HTML omitted --><!-- raw HTML omitted -->  assertEquals(1, Toto.get().size());<!-- raw HTML omitted --> <!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->I am quite used to static initialization, and would have answered the same as the first answer in the thread:<!-- raw HTML omitted -->&ldquo;Get is static and associated with TotoParent, so that is the same as calling TotoParent.get().size()&rdquo;. I would have even thought that the compiler would compile the call Toto.get() to TotoParent.get(). But running javap, you can see it is still compiled as TotoParent.get(). So there is still a lookup done. This is why the first answer is actually not that correct.<!-- raw HTML omitted --><!-- raw HTML omitted -->The important bit here is that Toto is never initialized, even if we call Toto.get(). The java specs (invaluable reference) explains clearly that calling a static method not declared in the class does not initialize the class.<!-- raw HTML omitted --><!-- raw HTML omitted -->Calling Toto.get() is not exactly the same as calling TotoParent.get().<!-- raw HTML omitted -->If TotoParent.get() called another TotoSuperParent.get():<!-- raw HTML omitted -->Toto.get() -&gt; TotoParent.get() -&gt; TotoSuperParent.get()<!-- raw HTML omitted -->We compile then later we change to make TotoParent have a specific implementation of get(). Toto will then be automatically aware of it, without even recompiling it.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="http://java.sun.com/docs/">http://java.sun.com/docs/</a><!-- raw HTML omitted -->books/jls/third_edition/html/<!-- raw HTML omitted -->execution.html<!-- raw HTML omitted --><!-- raw HTML omitted -->paragraph 12.4.1</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/benchmarking-languages-is-difficult/">Benchmarking Languages Is Difficult</a>
  </h1>
  <time datetime="2009-06-03T16:53:00Z" class="post-date">Wed, Jun 3, 2009</time>
  <p>I often looked at the famous computer languages shootout for fun. Recently I noticed they had the infamous <!-- raw HTML omitted -->thread ring test<!-- raw HTML omitted -->. I posted not very long ago several <!-- raw HTML omitted -->blog entries about it showing how silly<!-- raw HTML omitted --> this test was.<!-- raw HTML omitted --><!-- raw HTML omitted -->Looking at the existing Java implementation for the test I decided to try to submit the tricky one using a pool of thread, and pooling message processing rather creating 1 thread per node. To my surprise, it was accepted without questions and I did have the best score for a Java program for a while. Shortly after <!-- raw HTML omitted -->someone else<!-- raw HTML omitted --> copied my program and got rid of various stuff not useful for the particular benchmark (breaking the interesting part of the design) and got accepted as well with of course a better result.<!-- raw HTML omitted --><!-- raw HTML omitted -->I decided to see if I could make an <!-- raw HTML omitted -->even more silly program<!-- raw HTML omitted --> - tailored for the test only. I managed to be orders of magnitude faster - 1 thread, no synchronization, everything processed in a FIFO (linkedlist) queue. This is actually a standard way to reimplement recursion. But I was honest enough not to hide that I consider that kind of program to cheat the test and got my entry in the &ldquo;interesting alternatives&rdquo;.<!-- raw HTML omitted --><!-- raw HTML omitted -->In reality there is no difference in the &ldquo;cheating&rdquo; between my new program and the program that got accepted in the official list, they both cheat by using only 1 thread and process everything 1 by 1. There is not 1 thread per node in any of the program, and they can avoid any concurrency issues. One &ldquo;looks&rdquo; better because it uses a pool of 503 threads (but really use only 1 or 2 threads) and the other does not hide its use of 1 thread for processing. But this is not evident to people accepting the programs.<!-- raw HTML omitted --><!-- raw HTML omitted -->When I look at the haskell code, I can not really tell if it is creating 503 threads in the language or a pool or &hellip;, you have to know each language quite well and sometimes it is not that easy to define what cheating is. Therefore this kind of benchmark is a bit disappointing. One should force the use of the same algorithm. But can you do so (a functional language won&rsquo;t use the same algo as a procedural one)?</p>

  
</article>
</div>
<p style="text-align:left; width:49%; display: inline-block;"><a href="/page/21/">Previous</a></p>
<p style="text-align:right; width:50%;  display: inline-block;"><a href="/page/23/">Next</a></p>
    </main>

    
      
    
  </body>
</html>
