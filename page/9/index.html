<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
	<meta name="generator" content="Hugo 0.23" />
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Chase the Devil &middot; </title>

  
  <link rel="stylesheet" href="http://chasethedevil.github.io/css/poole.css">
  <link rel="stylesheet" href="http://chasethedevil.github.io/css/hyde.css">
  <link rel="stylesheet" href="http://chasethedevil.github.io/css/poole-overrides.css">
  <link rel="stylesheet" href="http://chasethedevil.github.io/css/hyde-overrides.css">
  <link rel="stylesheet" href="http://chasethedevil.github.io/css/hyde-x.css">
  <link rel="stylesheet" href="http://chasethedevil.github.io/css/highlight/sunburst.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=UnifrakturMaguntia:400,700">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://chasethedevil.github.io/touch-icon-144-precomposed.png">
  <link href="http://chasethedevil.github.io/favicon.png" rel="icon">

  
  
  
  <link href="http://chasethedevil.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Chase the Devil &middot; " />

  <meta name="description" content="">
  <meta name="keywords" content="">
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-365717-1', 'auto');
    ga('send', 'pageview');
  </script>
  
<script type="text/javascript"
  src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<link href=' http://fonts.googleapis.com/css?family=UnifrakturMaguntia' rel='stylesheet' type='text/css'>
</head>
<body class="theme-base-00">
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      
      <h1>Chase the Devil</h1>
      <p class="lead">Technical blog for Fabien.</p>
    </div>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item"><a href="http://chasethedevil.github.io/">Blog</a></li>
      
      <li class="sidebar-nav-item"><a href="http://chasethedevil.github.io/about/">About</a></li>
      
      <li class="sidebar-nav-item"><a href="http://chasethedevil.github.io/post/">Posts</a></li>
      
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <script type="text/javascript">document.write("<a href=\"mail" + "to:" + new Array("fabien","2ipi.com").join("@") + "?subject=your%20blog\">" + '<i class="fa fa-envelope fa-3x"></i>' + "</" + "a>");</script>  
      
      
      
      
      
      
      <a href="https://twitter.com/logos01"><i class="fa fa-twitter-square fa-3x"></i></a>
      
      <a href="http://chasethedevil.github.io/index.xml" type="application/rss+xml"><i class="fa fa-rss-square fa-3x"></i></a>
      </li>
    </ul>

    

    
  </div>
</div>


<div class="content container">
  <div class="posts">
    
    
    <div class="post">
      <h1 class="post-title">
        <a href="http://chasethedevil.github.io/post/fast-and-accurate-implied-volatility-solver/">Fast and Accurate Implied Volatility Solver</a>
      </h1>
      <span class="post-date">Mar 19, 2014 &middot; 3 minute read &middot; <a href="http://chasethedevil.github.io/post/fast-and-accurate-implied-volatility-solver/#disqus_thread">Comments</a>
      </span>
      
      <p>The calibration of a stochastic volatility model or a volatility surface parameterization (like SVI) involves minimizing the model options volatilities against market options volatilities. Often, the model computes an option price, not an implied volatility. It is therefore useful to have a fast way to invert that option price to get back the implied volatility that corresponds to it. Furthermore during the calibration procedure, the model option price can vary widely: it is convenient to have a robust implied volatility solver.<br /><br />Another more basic use of implied volatility solvers, is for the computation of Black-Scholes greeks for a given market option price.<br /><br />A few years ago, P. Jaeckel produced a much better algorithm than a simple Newton or Brent solver, in his paper &ldquo;<a href="http://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=7&amp;cad=rja&amp;uact=8&amp;ved=0CHgQFjAG&amp;url=http%3A%2F%2Fwww.pjaeckel.webspace.virginmedia.com%2FByImplication.pdf&amp;ei=fcApU5zICumd0QXhwoGACg&amp;usg=AFQjCNF1RnfynBrckd79E9RVbhVhuXQrQg&amp;sig2=aQs-BabiCAO2Gt4tvP439g&amp;bvm=bv.62922401,d.d2k">By Implication</a>&rdquo;. There is also a much <a href="http://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0CDcQFjAA&amp;url=http%3A%2F%2Fpapers.ssrn.com%2Fsol3%2Fpapers.cfm%3Fabstract_id%3D1027282&amp;ei=_cApU5rFJunN0QWL84DQCw&amp;usg=AFQjCNGqV-aWNuy4K35Z6xkl9aaYPZ1WHg&amp;sig2=rXhXZbu3YWvVvBxwrlTtxg&amp;bvm=bv.62922401,d.d2k">simpler algorithm from Li</a>, based on SOR and a good initial guess for SOR, which I found to be actually quite robust and fast. Now P. Jaeckel has <a href="http://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=2&amp;cad=rja&amp;uact=8&amp;ved=0CC8QFjAB&amp;url=http%3A%2F%2Fwww.pjaeckel.webspace.virginmedia.com%2FLetsBeRational.pdf&amp;ei=S88pU7jfI8rJ0QWbv4D4AQ&amp;usg=AFQjCNHv9QC9I_jV-d4VC4JCYganedrhsA&amp;sig2=ivH2tEG0rgUvrBx9mR-QZw&amp;bvm=bv.62922401,d.d2k">a newer algorithm</a>, faster and more accurate, close to double accuracy.<br /><br />I have tested those on 1 million options of random volatility (between 0.001 and 3), random strikes (N deviations with a cap at 1M) for a few expiries.<br /><br />In terms of performance, the results are independent of expiries, but in terms of accuracy, the new Jaeckel algorithm is particularly more accurate for the long-term options (5y and 15y).<br /><span style="font-size: x-small;"><br /></span><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">Algorithm&nbsp;&nbsp; Expiry&nbsp; Vol RMSE&nbsp; Price RMSE&nbsp; Time</span></span><br /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">Jaeckel2014 5y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.8E-16&nbsp;&nbsp; 2.1E-16&nbsp;&nbsp;&nbsp;&nbsp; 1.8s</span></span><br /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">Jaeckel2006 5y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.3E-10&nbsp;&nbsp; 1.1E-10&nbsp;&nbsp;&nbsp;&nbsp; 3.0s</span></span><br /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">Jaeckel2014 15y&nbsp;&nbsp;&nbsp;&nbsp; 2.0E-12&nbsp;&nbsp; 2.4E-16&nbsp;&nbsp;&nbsp;&nbsp; 1.8s</span></span><br /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">Jaeckel2006 15y&nbsp;&nbsp;&nbsp;&nbsp; 1.5E-7&nbsp;&nbsp;&nbsp;&nbsp;8.0E-11&nbsp;&nbsp;&nbsp;&nbsp; 2.7s</span></span><br /><br />The maximum error from Jaeckel2006 is around 1e-8, while the one from Jaeckel2014 is 2e-15 (for very large unrealistic strike)<br /><br />As a comparison, the simpler Li SOR-TS algorithm follows the given price accuracy independently of the expiry; I have tested with 1E-12. The error in implied volatility will be slightly higher: different close vols can give the same price due to the maximum achievable accuracy of the Black-Scholes formula with double numbers, even with <a href="http://chasethedevil.github.io/post/from-double-precision-normal-density-to-double-precision-cumulative-normal-distribution/">a good cumulative normal distribution implementation</a>. Its performance is however dependent on the number of deviations considered: closer to ATM means faster for Li algorithm.<br /><br /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">Algorithm&nbsp;&nbsp; Expiry&nbsp; Deviation&nbsp; Vol RMSE&nbsp; Price RMSE&nbsp; Time</span></span><br /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">Jaeckel2014 1y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5 &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4.2E-16&nbsp;&nbsp; 2.0E-17 &nbsp;&nbsp;&nbsp; 1.8s</span></span><br /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">LiSORTS &nbsp; &nbsp; 1y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8.5E-9 &nbsp;&nbsp; 1.9E-13 &nbsp;&nbsp;&nbsp; 2.1s</span></span><br /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">Jaeckel2014 1y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.1E-16 &nbsp; 5.9E-17 &nbsp;&nbsp;&nbsp; 1.7s</span></span><br /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">LiSORTS &nbsp; &nbsp; 1y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3 &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 4.3E-12 &nbsp; 1.6E-13 &nbsp;&nbsp;&nbsp; 1.3s</span></span><br /><br />Actually, I have cheated in my Li SOR-TS implementation: I have reused the idea from P. Jaeckel to compute the Black-Scholes price with <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">erfc_x</span> (unscaled erfc) instead of <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">erfc</span>. This simple change divides the number of <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">exp</span> calls by 2. Without this trick, for 5 deviations, SOR-TS took 3.6s (almost twice the time).<br /><br />I would not be surprised if this was the main performance improvement between the two Jaeckels.</p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="http://chasethedevil.github.io/post/arbitrage-free-interpolation-of-option-prices-using-piecewise-constant-density/">Arbitrage Free Interpolation of Option Prices using Piecewise Constant Density</a>
      </h1>
      <span class="post-date">Mar 17, 2014 &middot; 2 minute read &middot; <a href="http://chasethedevil.github.io/post/arbitrage-free-interpolation-of-option-prices-using-piecewise-constant-density/#disqus_thread">Comments</a>
      </span>
      
      <p>Tension splines can produce in some cases <a href="http://chasethedevil.github.io/post/c2-arbitrage-free-interpolation-with-tension-splines/">arbitrage free C2 interpolation</a> of options, but unfortunately this is not guaranteed. It turns out that, on some not so nice looking data, where the discrete probability density is not monotone but only positive, all previously considered interpolation fail (spline in volatility or variance, tension spline in log prices, harmonic spline on prices).<br /><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">K &nbsp; &nbsp; vol&nbsp;&nbsp; put&nbsp;&nbsp; b-slope&nbsp; b-convexity<br />300.0 0.682 0.090 0.00e+00 0.00e+00<br />310.0 0.654 0.136 4.60e-03 0.00e+00<br />320.0 0.621 0.192 5.60e-03 1.00e-03<br />330.0 0.594 0.288 9.60e-03 4.00e-03<br />340.0 0.560 0.404 1.16e-02 2.00e-03<br />350.0 0.520 0.530 1.26e-02 1.00e-03<br />360.0 0.484 0.736 2.06e-02 8.00e-03<br />370.0 0.467 1.232 4.96e-02 2.90e-02<br />380.0 0.442 1.898 6.66e-02 1.70e-02<br />390.0 0.427 3.104 1.21e-01 5.40e-02<br />400.0 0.412 4.930 1.83e-01 6.20e-02</span><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-AILZMFsJ09w/Uyb9SWnrYbI/AAAAAAAAHFE/3wzhISGziaU/s1600/Screenshot+from+2014-03-17+14:34:04.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-AILZMFsJ09w/Uyb9SWnrYbI/AAAAAAAAHFE/3wzhISGziaU/s1600/Screenshot+from+2014-03-17+14:34:04.png" height="373" width="400" /></a></div><br />Possibly the simplest arbitrage free interpolation is to postulate the density as piecewise constant, ideally centered around each strike (if not centered, there is no guarantee that it will be positive). If a spline is used for interpolation, this means a quadratic spline. Unfortunately, because it is not C2, it then still fails to be arbitrage free.<br />It is also possible to price by integrating the payoff over the density. There is then one degree of freedom, the Fmin (minimum forward allowed before absorption) that can be adjusted so as to make the density always positive. This produces our only arbitrage free interpolation of the above input put option prices.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-oyqkgeadz-I/Uyb_kjOjQ7I/AAAAAAAAHFQ/M0s2yemHbOA/s1600/Screenshot+from+2014-03-17+14:33:39.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-oyqkgeadz-I/Uyb_kjOjQ7I/AAAAAAAAHFQ/M0s2yemHbOA/s1600/Screenshot+from+2014-03-17+14:33:39.png" height="299" width="320" /></a></div>The implied volatility looks reasonable on this strange input: very much like a spline on volatilities. In contrast, the parabolic interpolator produces an oddly looking implied volatility shape, even though the density is in a way similar: piecewise constant. This is likely because I forced the second derivatives to match the discrete curvature, it is then not C1 in prices.<br /><br />Unfortunately, the piecewise constant density interpolant can also produce some strange implied volatility shapes, for example on P. Jaeckel example data:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-14AO4VdMh78/UycAWtv4TrI/AAAAAAAAHFY/lkqUFsJQY4A/s1600/Screenshot+from+2014-03-17+14:33:02.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-14AO4VdMh78/UycAWtv4TrI/AAAAAAAAHFY/lkqUFsJQY4A/s1600/Screenshot+from+2014-03-17+14:33:02.png" height="373" width="400" /></a></div>We find back the wiggles for large strikes. The lower end is particularly funny (which could be due to the fact that I don&rsquo;t have the data for low strikes). This is the corresponding density:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-GBq_zDoLDyE/UycAuk7Ui0I/AAAAAAAAHFg/f1fmWrcq1XY/s1600/Screenshot+from+2014-03-17+14:32:27.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-GBq_zDoLDyE/UycAuk7Ui0I/AAAAAAAAHFg/f1fmWrcq1XY/s1600/Screenshot+from+2014-03-17+14:32:27.png" height="373" width="400" /></a></div><br />It appears then not so easy to produce a simple generally good looking interpolation.<br /><br /></p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="http://chasethedevil.github.io/post/c2-arbitrage-free-interpolation-with-tension-splines/">C2 Arbitrage Free Interpolation with Tension Splines</a>
      </h1>
      <span class="post-date">Mar 11, 2014 &middot; 2 minute read &middot; <a href="http://chasethedevil.github.io/post/c2-arbitrage-free-interpolation-with-tension-splines/#disqus_thread">Comments</a>
      </span>
      
      <p>In a previous post, I have explored the <a href="http://chasethedevil.github.io/post/arbitrage-free-wiggles/">arbitrage free wiggles</a> in the volatility surface that P. Jaeckel found in <a href="http://www.pjaeckel.webspace.virginmedia.com/ClampingDownOnArbitrage.pdf">his paper</a>. I showed that interpolating in log prices instead of prices was enough to remove the wiggles, but then, it appears that the interpolation is not guaranteed to be arbitrage free, even though it often is. On another example from P. Jaeckel paper, that I reproduced inaccurately but well enough, it is not.<br /><br />Using a Harmonic spline instead of a regular cubic spline seems to be enough to make the interpolation arbitrage free in practice (although not in theory as log-prices are not convex), but it is only C1.<br /><br />One can use a tension spline instead. There is an algorithm from Pruess that updates the tension parameters so as to make the interpolation monotone and convex. It can be tweaked to ensure that the interpolation follows:<br />$$f&rsquo;^2 + f&rdquo; \geq 0$$<br /><br />This condition makes the interpolation on the log prices arbitrage free. As a first draft experiment, I just ensured numerically that the condition was valid, the resulting algorithm was fast enough and worked reasonably well.<br /><br />Here is how the normalized density looks like with a simple harmonic spline on the call prices, a cubic spline in the logarithm of call prices, and an optimized tension spline in the logarithm of call prices.<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-57uxyS3_9vg/UyCYD8H2FWI/AAAAAAAAHE0/m9QIhAFlg0k/s1600/Screenshot+from+2014-03-12+18:23:02.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://3.bp.blogspot.com/-57uxyS3_9vg/UyCYD8H2FWI/AAAAAAAAHE0/m9QIhAFlg0k/s1600/Screenshot+from+2014-03-12+18:23:02.png" height="376" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">logarithm of the curvature</td></tr></tbody></table><div class="separator" style="clear: both; text-align: center;"></div><br />The blank spot for the Log curve (spline) corresponds to negative curvature, that is, arbitrage. Notice how the tension spline is fully continuous, with no real spikes.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-54gzqNxjpUw/Ux80PYHpBXI/AAAAAAAAHEk/1XtMX89M5vI/s1600/Screenshot+from+2014-03-11+16:50:37.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-54gzqNxjpUw/Ux80PYHpBXI/AAAAAAAAHEk/1XtMX89M5vI/s1600/Screenshot+from+2014-03-11+16:50:37.png" height="341" width="400" /></a></div>The implied volatility curve is very close to a more classic cubic spline interpolation on the implied variance.<br /><br />Of course, the same kind of algorithm can be applied directly to the variance with a slightly different numerical test to ensure it is arbitrage-free, it might however be easier to find a more robust and more clever algorithm in the log prices.</p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="http://chasethedevil.github.io/post/bachelier-and-black-scholes-fits-of-the-volatility-surface-what-about-sabr/">Bachelier and Black-Scholes Fits of the Volatility Surface, what about SABR?</a>
      </h1>
      <span class="post-date">Mar 7, 2014 &middot; 2 minute read &middot; <a href="http://chasethedevil.github.io/post/bachelier-and-black-scholes-fits-of-the-volatility-surface-what-about-sabr/#disqus_thread">Comments</a>
      </span>
      
      <p>I always wondered if Bachelier was really worse than Black-Scholes in practice. As an experiment I fit various implied volatility surfaces with Bachelier and Black-Scholes and look at the average error in implied volatility by slice.<br /><br />In theory Bachelier is appealing because slightly simpler: log returns are a bit more challenging to think about than returns. And it also takes indirectly into account the fact that OTM calls are less likely than OTM puts because of default risk, if you assume absorbing probability at strike 0.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-FtWwKMYTItY/Uxn4UIURgnI/AAAAAAAAHDk/qJDWTdPl6gw/s1600/bachelier.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-FtWwKMYTItY/Uxn4UIURgnI/AAAAAAAAHDk/qJDWTdPl6gw/s1600/bachelier.png" height="336" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Bachelier</td></tr></tbody></table><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-XGjl9Pcs5aY/Uxn4aNFFB8I/AAAAAAAAHDs/-v8zOpNFu24/s1600/black.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-XGjl9Pcs5aY/Uxn4aNFFB8I/AAAAAAAAHDs/-v8zOpNFu24/s1600/black.png" height="336" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Black-Scholes</td></tr></tbody></table>The error is in general smaller for Black-Scholes for short expiries, and higher for long expiries when compared to Bachelier. Interestingly, in theory, the difference of the models is more pronounced for longer expiries. One would have imagined that for very short expiries Bachelier would be equivalent to Black, it is not the case in term of fitting the smile.<br /><br />Displaced diffusion (mixing both Bachelier and Black linearly) allows to gain x2 accuracy.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-zCvfSvMtsmc/Uxn5HHk0gBI/AAAAAAAAHD0/FrFzvnmnd08/s1600/dd.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://2.bp.blogspot.com/-zCvfSvMtsmc/Uxn5HHk0gBI/AAAAAAAAHD0/FrFzvnmnd08/s1600/dd.png" height="336" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Displaced Diffusion</td></tr></tbody></table>What about SABR? Let&rsquo;s look at lognormal SABR, usually used for equities.<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-lvB1kTAXh7U/Uxn5VHjEWvI/AAAAAAAAHD8/XMGwCisCiKg/s1600/sabr.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://2.bp.blogspot.com/-lvB1kTAXh7U/Uxn5VHjEWvI/AAAAAAAAHD8/XMGwCisCiKg/s1600/sabr.png" height="336" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Lognormal SABR (beta=1)</td></tr></tbody></table>The fit is much better for long expiries, but not so great for a few outliers for long maturities, it can be actually worse than the simple displaced diffusion. A normal SABR might fix that.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-QcGK_40mOHQ/Uxn5qLeI45I/AAAAAAAAHEE/tMWUPEtaxvs/s1600/sabr0.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://3.bp.blogspot.com/-QcGK_40mOHQ/Uxn5qLeI45I/AAAAAAAAHEE/tMWUPEtaxvs/s1600/sabr0.png" height="336" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Normal SABR (beta=0) using Hagan lognormal formula</td></tr></tbody></table>If one relies on the standard lognormal formula, the beta=0 SABR behaves very badly.<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-kpi0HJKc25o/Uxn57qj8QpI/AAAAAAAAHEM/TLBa6dseWzI/s1600/Screenshot+from+2014-03-07+17:35:49.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-kpi0HJKc25o/Uxn57qj8QpI/AAAAAAAAHEM/TLBa6dseWzI/s1600/Screenshot+from+2014-03-07+17:35:49.png" height="321" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Normal SABR using Hagan normal formula</td></tr></tbody></table>This is fixed using the normal (bpvol) Hagan formula directly. The fit is then better overall for long maturities as expected from Black-Scholes vs Bachelier behavior.<br /><br />If one look in log scale, the conclusion is not so obvious: beta=1 produces a better fit for a majority even for long expiries, but worse for a few (30% in my case) outliers.<br /><br />What&rsquo;s clear however, is that one should never use the Black implied volatility Hagan formula with beta=0. This leaves a question on displaced SABR. Is displaced SABR is better suited than SABR with varying beta?</p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="http://chasethedevil.github.io/post/arbitrage-free-wiggles/">Arbitrage Free Wiggles</a>
      </h1>
      <span class="post-date">Mar 3, 2014 &middot; 2 minute read &middot; <a href="http://chasethedevil.github.io/post/arbitrage-free-wiggles/#disqus_thread">Comments</a>
      </span>
      
      <p>Peter Jaeckel, in a <a href="http://www.pjaeckel.webspace.virginmedia.com/ClampingDownOnArbitrage.pdf">recent paper (pdf)</a>, shows that something that sounds like a reasonable arbitrage free interpolation can produce wiggles in the implied volatility slice.<br /><br />The interpolation in question is using some convexity preserving spline on call and put option prices directly and in strike, assuming those input prices are arbitrage free. This is very similar to <a href="http://nkahale.free.fr/papers/Interpolation.pdf">Kahale interpolation (pdf)</a>.<br /><br />It seemed too crazy for me so I had to try out his example. And using a <a href="http://papers.ssrn.com/abstract=2175002">harmonic spline</a>, it does produce arbitrage free wiggles.<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-HhHvYhvdlwU/UxSkNCTJiXI/AAAAAAAAHBQ/buAU6Q_wALM/s1600/Screenshot+from+2014-03-03+16:29:29.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://3.bp.blogspot.com/-HhHvYhvdlwU/UxSkNCTJiXI/AAAAAAAAHBQ/buAU6Q_wALM/s1600/Screenshot+from+2014-03-03+16:29:29.png" height="297" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Wiggles in the implied volatility</td></tr></tbody></table>If we look at the probability density (the curvature), the Harmonic spline maintains a positive density, nearly piecewise flat in log scale, while Hyman, because it preserves only monotonicity, has some negative density which are cut out from the graph.<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-UKuoXUcVRYY/UxSk1ylZ7jI/AAAAAAAAHBY/RDxMR2Q69GY/s1600/Screenshot+from+2014-03-03+16:47:46.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://2.bp.blogspot.com/-UKuoXUcVRYY/UxSk1ylZ7jI/AAAAAAAAHBY/RDxMR2Q69GY/s1600/Screenshot+from+2014-03-03+16:47:46.png" height="297" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Probability Density</td></tr></tbody></table>In reality, if we look at the interpolation of prices in log scale, one can see that splines won&rsquo;t behave as expected at first on small numbers: they will give a much higher weight to the high values, producing something like a piecewise linear interpolation.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-5WOPPmW088c/UxSml6PGWmI/AAAAAAAAHBk/xOfiaaRcpLI/s1600/Screenshot+from+2014-03-03+16:57:33.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-5WOPPmW088c/UxSml6PGWmI/AAAAAAAAHBk/xOfiaaRcpLI/s1600/Screenshot+from+2014-03-03+16:57:33.png" height="297" width="400" /></a></div><br />In reality, what one really wants for such data is to just interpolate the log prices with a spline, not the prices. This is the curve named &ldquo;Log&rdquo; in the graphs, where a simple cubic spline is used on the log prices, and fed to exp after interpolation.<br /><br />Now it sounds like a reasonable arbitrage free interpolation would be to interpolate the discrete density log linearly, in a similar spirit as <a href="http://finmod.co.za/interpreview.pdf">Hagan-West yield curve interpolation</a> (pdf).<br /><br />In general, if you interpolate very small numbers with a spline, you probably are doing something wrong.</p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="http://chasethedevil.github.io/post/adjoint-delta-for-monte-carlo/">Adjoint Delta for Monte-Carlo</a>
      </h1>
      <span class="post-date">Feb 25, 2014 &middot; 1 minute read &middot; <a href="http://chasethedevil.github.io/post/adjoint-delta-for-monte-carlo/#disqus_thread">Comments</a>
      </span>
      
      <p>In an earlier post, I have been quickly exploring <a href="http://chasethedevil.github.io/post/adjoint-algorithmic-differentiation-for-black-scholes/">adjoint differentiation</a> in the context of analytical Black-Scholes. Today, I tried to mix it in a simple Black-Scholes Monte-Carlo as described in <a href="http://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;ved=0CCsQFjAA&amp;url=http%3A%2F%2Fwww.luca-capriotti.net%2Fpdfs%2FFinance%2Fjcf_capriotti_press_web.pdf&amp;ei=rNMMU4_wGKjt0gWQpYGIAQ&amp;usg=AFQjCNFovkw47-Y1WrIKkt-m5FQ1lhmqYA&amp;sig2=vmiqHzd6SJuq5Fp2TlPjdA&amp;bvm=bv.61725948,d.d2k">L. Capriotti paper</a>, and measured the performance to compute delta compared to a numerical single sided finite difference delta.<br /><br />I was a bit surprised that even on a single underlying, without any real optimization, adjoint delta was faster by a factor of nearly 40%. I suspect this is mostly due to exp evaluations being /2.<br /><br />On a basket of 4 assets, the adjoint method was 3.25x faster.<br /><br />It&rsquo;s quick to have such results on basic payoffs: it took me a few hours and worked on the first run, even though my Monte-Carlo is slightly different from the Capriotti paper. It is much more challenging to have it working across a wide variety of payoffs, and to automatize some of it.</p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="http://chasethedevil.github.io/post/svi-on-top-of-sabr/">SVI on top of SABR</a>
      </h1>
      <span class="post-date">Feb 20, 2014 &middot; 1 minute read &middot; <a href="http://chasethedevil.github.io/post/svi-on-top-of-sabr/#disqus_thread">Comments</a>
      </span>
      
      <p>Several papers show that the limit for large strikes of <a href="http://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=2&amp;cad=rja&amp;ved=0CDUQFjAB&amp;url=http%3A%2F%2Farxiv.org%2Fabs%2F1002.3633&amp;ei=GjUGU5uVIeu00wXEwoCwBw&amp;usg=AFQjCNHvnJ9xYAv60R4GSUbMORRI9_-7Zg&amp;sig2=iqplpcXauJBLJ9DIw71vWA&amp;bvm=bv.61725948,d.d2k">Heston is SVI</a>.<br /><br />Interestingly, I stumbled onto a surface where the Hagan SABR fit was perfect as well as the SVI fit, while the Heston fit was not.<br /><br />Originally, I knew that, on this data, the SVI fit was perfect. Until today, I just never tried to fit a lognormal SABR on the same data. I did a small test with random values of the SABR parameters alpha, rho, nu, and found out that in deed, the SVI fit is always perfect on SABR.<br /><br />Is this just because the Taylor expansion of SVI will match the Taylor expansion of SABR up to the fourth order? It seems that the wings are also not too far off in general so there could be more to it.<br /><br />Gatheral actually devised an SVI formula that uses SABR like variables <a href="http://mfe.baruch.cuny.edu/wp-content/uploads/2013/01/OsakaSVI2012.pdf">in a talk here</a>.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-QNLwJnVGPUE/UwY9EwCkZ6I/AAAAAAAAHA4/DP6MstmUqg4/s1600/Screenshot+from+2014-02-20+18:36:06.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-QNLwJnVGPUE/UwY9EwCkZ6I/AAAAAAAAHA4/DP6MstmUqg4/s1600/Screenshot+from+2014-02-20+18:36:06.png" height="79" width="320" /></a></div><br /><br />Of course, the reverse is not true. SVI has more parameters and provides in general a better fit than SABR.</p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="http://chasethedevil.github.io/post/smart-initial-guess-for-schobel-zhu/">Smart Initial Guess for Schobel-Zhu</a>
      </h1>
      <span class="post-date">Feb 19, 2014 &middot; 2 minute read &middot; <a href="http://chasethedevil.github.io/post/smart-initial-guess-for-schobel-zhu/#disqus_thread">Comments</a>
      </span>
      
      <p>With a <a href="http://chasethedevil.github.io/post/a-small-time-schobel-zhu-expansion/">small time expansion</a>, it is easy to derive a reasonable initial guess, without resorting to some global minimizer.<br /><br />Like <a href="http://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;ved=0CCgQFjAA&amp;url=http%3A%2F%2Fpage.math.tu-berlin.de%2F~jacquier%2Findex_files%2FJacquier%2520-%2520SmallTimeHeston2.pdf&amp;ei=72D7Ur6NHeqP0AX7soFo&amp;usg=AFQjCNGkx9ifAh3UQQI4UE_pD8osCzH7Rg&amp;sig2=lIcs-s2yrxWZsxidkQlxOA&amp;bvm=bv.61190604,d.d2k">Forde &amp; al did for Heston</a>, one can find the 5 Schobel-Zhu parameters through 5 points at coordinates (0,0), (x0,t1), (-x0,t1), (x0,t2), (-x0,t2), where x0 is a chosen the log-moneyness, for example, 0.1 and t1, t2 relatively short expiries (for example, 0.1, 0.25).<br /><br />We can truncate the small time expansion so that the polynomial in (x,t) is fully captured by those 5 points. In practice, I have noticed that using a more refined expansion with more terms resulted not only in more complex formulas to lookup the original stochastic volatility parameters, but also in an increased error, because of the redundancy of parameters in the polynomial expansion. My previous Schobel-Zhu expansion becomes just:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-uBWPjGvFZtU/UwTk03igscI/AAAAAAAAHAo/u4unVlkOFG0/s1600/Screenshot+from+2014-02-19+18:07:07.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-uBWPjGvFZtU/UwTk03igscI/AAAAAAAAHAo/u4unVlkOFG0/s1600/Screenshot+from+2014-02-19+18:07:07.png" height="137" width="320" /></a></div><br />In practice, I have found that the procedure works rather well.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-SAv0EczOlvA/UwTkNixNOfI/AAAAAAAAHAg/LE4yfQZfC3s/s1600/Screenshot+from+2014-02-19+18:04:33.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-SAv0EczOlvA/UwTkNixNOfI/AAAAAAAAHAg/LE4yfQZfC3s/s1600/Screenshot+from+2014-02-19+18:04:33.png" height="116" width="400" /></a></div>On some more extreme surfaces, where theta=0, the error in kappa and theta is higher. Interestingly, I received a few real world surfaces like this, where theta=0, which I found a bit puzzling. I wondered if it was because those surfaces were preprocessed with SABR, that has no mean reversion, but I could not fit those exactly with SABR.<br /><br /><b>Update March 2014</b> - this is now described in my paper <a href="http://ssrn.com/abstract=2362968">Fourier Integration and Stochastic Volatility Calibration</a>.&nbsp;</p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="http://chasethedevil.github.io/post/a-look-at-small-time-expansions-for-heston/">A Look at Small Time Expansions for Heston</a>
      </h1>
      <span class="post-date">Feb 12, 2014 &middot; 2 minute read &middot; <a href="http://chasethedevil.github.io/post/a-look-at-small-time-expansions-for-heston/#disqus_thread">Comments</a>
      </span>
      
      <p>Small time expansions for Heston can be useful during the calibration of the implied volatility surface, in order to find an initial guess for a local minimizer (for example, Levenberg-Marquardt). Even if they are not so accurate, they capture the dynamic of the model parameters, and that is often enough.<br /><br />In 2011, Forde et al. proposed <a href="http://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;ved=0CCgQFjAA&amp;url=http%3A%2F%2Fpage.math.tu-berlin.de%2F~jacquier%2Findex_files%2FJacquier%2520-%2520SmallTimeHeston2.pdf&amp;ei=72D7Ur6NHeqP0AX7soFo&amp;usg=AFQjCNGkx9ifAh3UQQI4UE_pD8osCzH7Rg&amp;sig2=lIcs-s2yrxWZsxidkQlxOA&amp;bvm=bv.61190604,d.d2k">a second order small time expansion</a> around the money, which I found to work well for calibration. More recently, Lorig et al. proposed <a href="http://arxiv.org/abs/1306.5447">different expansions up to order-3</a> around the money. I already looked at the later in my <a href="http://chasethedevil.github.io/post/a-small-time-schobel-zhu-expansion/">previous post</a>, applying the idea to Schobel-Zhu.<br /><br />I noticed, however, that on some surfaces, the Lorig expansion was quickly very inaccurate (LPP1 for order-1, LPP2 for order-2, LPP3 for order-3). Those surfaces seem to be the ones were the Feller condition is largely violated. In practice, in my set of volatility surfaces for 10 different equities/indices, the best fit is always produced by Heston parameters where the Feller condition is violated.<br /><div class="separator" style="clear: both; text-align: center;"></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-86ukJOiiEq8/UvtkhCljuKI/AAAAAAAAHAI/J7349pkWjsU/s1600/heston_expansions_order3a.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-86ukJOiiEq8/UvtkhCljuKI/AAAAAAAAHAI/J7349pkWjsU/s1600/heston_expansions_order3a.png" height="378" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">T=0.5, Feller condition largely violated</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-fO0cCblLkFk/UvtkjiYK1PI/AAAAAAAAHAQ/8jwHVPg0Tp8/s1600/heston_expansions_order3b.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-fO0cCblLkFk/UvtkjiYK1PI/AAAAAAAAHAQ/8jwHVPg0Tp8/s1600/heston_expansions_order3b.png" height="378" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">T=0.5, Feller condition slightly violated</td></tr></tbody></table><br /><br />Out of curiosity, I calibrated my surfaces feeding the order-1 approximation to the differential evolution, in order to find my initial guess, and it worked for all surfaces.<br />The order-3 formula, even though it is more precise at the money, was actually more problematic for calibration: it failed to find a good enough initial guess in some cases, maybe because the reference data should be truncated, to possibly keep the few shortest expiries, and close to ATM strikes.<br /><br /></p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="http://chasethedevil.github.io/post/a-small-time-schobel-zhu-expansion/">A Small-Time Schobel-Zhu Expansion</a>
      </h1>
      <span class="post-date">Feb 10, 2014 &middot; 1 minute read &middot; <a href="http://chasethedevil.github.io/post/a-small-time-schobel-zhu-expansion/#disqus_thread">Comments</a>
      </span>
      
      <p>The paper &ldquo;<a href="http://arxiv.org/abs/1306.5447">implied vol for any local stochastic vol model</a>&rdquo; from Lorig et al. presents a very generic and simple formula to compute implied volatility expansions up to order-2 (there is actually an order-3 formula available in their Mathematica CDF file).<br /><br />I tried it on the <a href="http://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=2&amp;cad=rja&amp;ved=0CDIQFjAB&amp;url=http%3A%2F%2Fssrn.com%2Fabstract%3D100831&amp;ei=3gr5UtzkOYm90QWD7IDwBA&amp;usg=AFQjCNFY9anH_AU0A5pWRX4Qdo6Kp2CjEg&amp;sig2=teGVgsV4uneROlzZCuUFBw&amp;bvm=bv.60983673,d.d2k">Schobel-Zhu</a> stochastic volatility model. This model is an interesting alternative to Heston. I found that, in practice, the implied volatility surface <a href="http://chasethedevil.github.io/post/heston-schobel-zhu-bates-double-heston-fit/">fit was as good</a>, while the <a href="http://chasethedevil.blogspot.fr/2014/01/brownian-bridge-or-not-with-heston.html">simulation under the QE scheme</a> is quite faster (and simpler) than Heston. Here is the result of applying their technique on Schobel-Zhu:<br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-7FEfNo0V6b4/UvkLxXhipFI/AAAAAAAAG_k/DaVO2Ed_tCs/s1600/SZ_EXP1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-7FEfNo0V6b4/UvkLxXhipFI/AAAAAAAAG_k/DaVO2Ed_tCs/s1600/SZ_EXP1.png" height="250" width="320" /></a></div>And this is how it behaves on some realistic input:<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-Uf1ud5lKlpk/UvkMHxoDhGI/AAAAAAAAG_s/fzwZCCQuOY0/s1600/Screenshot+from+2014-02-10+18:16:06.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://3.bp.blogspot.com/-Uf1ud5lKlpk/UvkMHxoDhGI/AAAAAAAAG_s/fzwZCCQuOY0/s1600/Screenshot+from+2014-02-10+18:16:06.png" height="288" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">T=0.1</td></tr></tbody></table><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-xjOTdJKFcKs/UvkMY331XSI/AAAAAAAAG_0/dUfc-ZYLLjg/s1600/Screenshot+from+2014-02-10+18:28:32.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-xjOTdJKFcKs/UvkMY331XSI/AAAAAAAAG_0/dUfc-ZYLLjg/s1600/Screenshot+from+2014-02-10+18:28:32.png" height="288" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">T=0.5</td></tr></tbody></table>In practice, while not extremely good, it seems to be enough for Calibration to find an initial guess via differential evolution.<br /><br /><b>Update March 2014</b> - this is now described in my paper <a href="http://ssrn.com/abstract=2362968">Fourier Integration and Stochastic Volatility Calibration</a>.</p>

      
    </div>
    
    

<ul class="pagination">
    
    <li>
        <a href="/" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
    </li>
    
    <li
    >
    <a href="/page/8/" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
    </li>
    
    
    
    
    
     
        
        
    
    
    <li
    ><a href="/">1</a></li>
    
    
    
    
    
     
        
        
    
    
    <li
    ><a href="/page/2/">2</a></li>
    
    
    
    
    
     
        
        
    
    
    <li
    ><a href="/page/3/">3</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="disabled"><span aria-hidden="true">&hellip;</span></li>
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
     
        
        
    
    
    <li
    ><a href="/page/8/">8</a></li>
    
    
    
    
    
     
        
        
    
    
    <li
    class="active"><a href="/page/9/">9</a></li>
    
    
    
    
    
     
        
        
    
    
    <li
    ><a href="/page/10/">10</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="disabled"><span aria-hidden="true">&hellip;</span></li>
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
     
        
        
    
    
    <li
    ><a href="/page/37/">37</a></li>
    
    
    <li
    >
    <a href="/page/10/" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
    </li>
    
    <li>
        <a href="/page/37/" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
    </li>
    
</ul>

  </div>
</div>


<script type="text/javascript">
var disqus_shortname = "chasethedevil";
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>

<div class="content container" style="padding-top: 0rem;"-->
 <a href="https://twitter.com/share" class="twitter-share-button"{count} data-hashtags="chasethedevil" data-size="large">Tweet</a>
 <a style="font-size:75%;" href="//www.reddit.com/submit" onclick="window.location = '//www.reddit.com/submit?url=' + encodeURIComponent(window.location); return false"><i class="fa fa-reddit fa-2x" aria-hidden="true"></i>Submit to reddit</a> 
<table style="border-collapse: collapse;">
     <tr style="padding: 0px; margin: 0px; border: none;">
     <td style="vertical-align: middle;padding: 0px; margin: 0px; border: none;font-size: 60%;">&copy; 2006-16 <a href="http://chasethedevil.github.io/about/">Fabien</a></td>
     <td style="vertical-align: middle;padding: 0px; margin: 0px; border: none;font-size: 0px;"><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="padding: 0px; margin: 0px; border: none;" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a></td>
     <td style="vertical-align: middle;padding: 0px; margin: 0px; border: none;font-size: 60%;">This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</td></tr></table>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
</div>
<script src="http://chasethedevil.github.io/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script>
  var _gaq=[['_setAccount','UA-365717-1'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

</body>
</html>

