<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.83.1" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Chase the Devil</title>
  <meta name="description" content="A personal, independent, technical blog" />

  
  <link type="text/css" rel="stylesheet" href="https://chasethedevil.github.io/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://chasethedevil.github.io/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://chasethedevil.github.io/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://chasethedevil.github.io/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">
<link href="https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&display=swap" rel="stylesheet">
 <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="https://chasethedevil.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Chase the Devil" />
  <script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

</head>

  <body class=" ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://chasethedevil.github.io/"><h1 style="font-family: 'UnifrakturMaguntia', cursive;font-weight: normal;">Chase the Devil</h1></a>
      <p class="lead">
       A personal, independent, technical blog 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://chasethedevil.github.io/">Blog</a> </li>
        <li><a href="/about/"> About </a></li><li><a href="/post/"> Posts </a></li>
      </ul>

        <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <script type="text/javascript">document.write("<a href=\"mail" + "to:" + new Array("fabien","2ipi.com").join("@") + "?subject=your%20blog\">" + '<i class="fa fa-envelope fa-3x"></i>' + "</" + "a>");</script>
      
      
      
      
      
      
      <a href="https://twitter.com/logos01"><i class="fa fa-twitter-square fa-3x"></i></a>
      
      <a href="https://chasethedevil.github.io/index.xml" type="application/rss+xml"><i class="fa fa-rss-square fa-3x"></i></a>
      </li>
    </ul>
 </nav>

    <p>&copy; 2021. All rights reserved. </p>
  </div>
</aside>

    <main class="content container">
    <div class="posts">
<article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/volatility-swap-vs-variance-swap-replication-truncation/">Volatility Swap vs Variance Swap Replication - Truncation</a>
  </h1>
  <time datetime="2015-03-16T14:39:00Z" class="post-date">Mon, Mar 16, 2015</time>
  <p>I have looked at <!-- raw HTML omitted -->jump effects on volatility vs. variance swaps<!-- raw HTML omitted -->. There is a similar behavior on tail events, that is, on truncating the replication.<!-- raw HTML omitted --><!-- raw HTML omitted -->One main <!-- raw HTML omitted -->problem with discrete replication of variance swaps<!-- raw HTML omitted --> is the implicit domain truncation, mainly because the variance swap equivalent log payoff is far from being linear in the wings.<!-- raw HTML omitted --><!-- raw HTML omitted -->The equivalent payoff with Carr-Lee for a volatility swap is much more linear in the wings (<!-- raw HTML omitted -->not so far of a straddle<!-- raw HTML omitted -->). So we could expect the replication to be less sensitive to the wings truncation.<!-- raw HTML omitted --><!-- raw HTML omitted -->I have done a simple test on flat 40% volatility:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->As expected, the vol swap is much less sensitive, and interestingly, very much like for the jumps, it moves in the opposite direction: the truncated price is higher than the non truncated price.<!-- raw HTML omitted --><!-- raw HTML omitted --></p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/arbitrage-free-sabr-with-negative-rates-alternative-to-shifted-sabr/">Arbitrage free SABR with negative rates - alternative to shifted SABR</a>
  </h1>
  <time datetime="2015-03-11T18:48:00Z" class="post-date">Wed, Mar 11, 2015</time>
  <p><!-- raw HTML omitted -->Antonov et al.<!-- raw HTML omitted --> present an interesting view on SABR with negative rates: instead of relying on a shifted SABR to allow negative rates up to a somewhat arbitrary shift, they modify slightly the SABR model to allow negative rates directly:
$$ dF_t = |F_t|^\beta v_t dW_F $$
with \( v_t \) being the standard lognormal volatility process of SABR.<!-- raw HTML omitted --><!-- raw HTML omitted -->Furthermore they derive a clever semi-analytical approximation for this model, based on low correlation, quite close to the Monte-Carlo prices in their tests. It&rsquo;s however not clear if it is arbitrage-free.<!-- raw HTML omitted --><!-- raw HTML omitted -->It turns out that it is easy to tweak Hagan SABR PDE approach to this &ldquo;absolute SABR&rdquo; model: one just needs to push the boundary \(F_{min}\) far away, and to use the absolute value in C(F).<!-- raw HTML omitted --><!-- raw HTML omitted -->It then reproduces the same behavior as in Antonov et al. paper:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->&ldquo;Absolute SABR&rdquo; arbitrage free PDE<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Antonov et al. graph<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> I obtain a higher spike, it would look much more like Antonov graph had I used a lower resolution to compute the density: the spike would be smoothed out.<!-- raw HTML omitted --><!-- raw HTML omitted -->Interestingly, the arbitrage free PDE will also work for high beta (larger than 0.5):<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->beta = 0.75<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->It turns out to be then nearly the same as the absorbing SABR, even if prices can cross a little the 0. This is how the bpvols look like with beta = 0.75:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->red = absolute SABR, blue = absorbing SABR with beta=0.75<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->They overlap when the strike is positive.<!-- raw HTML omitted --><!-- raw HTML omitted -->If we go back to Antonov et al. first example, the bpvols look a bit funny (very symmetric) with beta=0.1:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->For beta=0.25 we also reproduce Antonov bpvol graph, but with a lower slope for the left wing:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->bpvols with beta = 0.25<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->It&rsquo;s interesting to see that in this case, the positive strikes bp vols are closer to the normal Hagan analytic approximation (which is not arbitrage free) than to the absorbing PDE solution.<!-- raw HTML omitted --><!-- raw HTML omitted -->For longer maturities, the results start to be a bit different from Antonov, as Hagan PDE relies on a order 2 approximation only:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->absolute SABR PDE with 10y maturity<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The right wing is quite similar, except when it goes towards 0, it&rsquo;s not as flat, the left wing is much lower.<!-- raw HTML omitted --><!-- raw HTML omitted -->Another important aspect is to reproduce Hagan&rsquo;s knee, the atm vols should produce a knee like curve, as different studies show (see for example <!-- raw HTML omitted -->this recent Hull &amp; White study<!-- raw HTML omitted --> or this <!-- raw HTML omitted -->other recent analysis by DeGuillaume<!-- raw HTML omitted -->). Using the same parameters as Hagan (beta=0, rho=0) leads to a nearly flat bpvol: no knee for the absolute SABR, curiously there is a bump at zero, possibly due to numerical difficulty with the spike in the density:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The problem is still there with beta = 0.1:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Overall, the idea of extending SABR to the full real line with the absolute value looks particularly simple, but it&rsquo;s not clear that it makes real financial sense.</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/variance-swaps-on-a-foreign-asset/">Variance swaps on a foreign asset</a>
  </h1>
  <time datetime="2015-02-24T13:50:00Z" class="post-date">Tue, Feb 24, 2015</time>
  <p>There is very little information on variance swaps on a foreign asset. There can be two kinds of contracts:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->one that pays the foreign variance in a domestic currency, this is a quanto contract as the exchange rate is implicitly fixed.<!-- raw HTML omitted --><!-- raw HTML omitted -->one that pays the foreign variance, multiplied by the fx rate at maturity. This is a flexo contract, and is just about buying a variance swap from a foreign bank. The price of such a contract today is very simple, just the standard variance swap price multiplied by the fx rate today (change of measure).<!-- raw HTML omitted --><!-- raw HTML omitted -->For quanto contracts, it&rsquo;s not so obvious a priori. If we consider a stochastic volatility model for the asset, the replication formula will not be applicable directly as the stochastic volatility will appear in the quanto drift correction. Furthermore, vanilla quanto option prices can not be computed simply as under Black-Scholes, a knowledge of the underlying model is necessary.<!-- raw HTML omitted --><!-- raw HTML omitted -->Interestingly, under the Schobel-Zhu model, it is simple to fit an analytic formula for the quanto variance swap. The standard variance swap price is:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The quanto variance swap can be priced with the same formula using a slightly different theta:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->We can use it to assess the accuracy of a naive quanto option replication where we use the ATM quanto forward instead of the forward in the variance swap replication formula.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Interestingly, the  quanto forward approximation turns out to be very accurate and the correction is important. The price without correction is the price with zero correlation, and we see it can be +/-5% off in this case.<!-- raw HTML omitted --><!-- raw HTML omitted -->The local vol price seems a bit off, I am not sure exactly why. It could be due the discretization, the theoretical variance should be divided by (N-1) but here we divide by N where N is the number of observations. That would still lead to a skewed price but better centered around correlation 0.<!-- raw HTML omitted --><!-- raw HTML omitted -->It&rsquo;s also a bit surprising that local vol is worse than the simpler ATM quanto forward approximation: it seems that it&rsquo;s extracting the wrong information to do a more precise quanto correction, likely related to the shift of stochastic volatility under the domestic measure.</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/jumps-impact-variance-swap-vs-volatility-swap/">Jumps impact: Variance swap vs volatility swap</a>
  </h1>
  <time datetime="2015-02-20T13:24:00Z" class="post-date">Fri, Feb 20, 2015</time>
  <!-- raw HTML omitted -->

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/variance-swap-replication-discrete-or-continuous/">Variance Swap Replication : Discrete or Continuous?</a>
  </h1>
  <time datetime="2015-02-19T18:45:00Z" class="post-date">Thu, Feb 19, 2015</time>
  <p>People regularly believe that Variance swaps need to be priced by discrete replication, because the market trades only a discrete set of options.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->In reality, a discrete replication will misrepresent the tail, and can be quite arbitrary. It looks like the discrete replication as described in <!-- raw HTML omitted -->Derman Goldman Sachs paper<!-- raw HTML omitted --> is in everybody&rsquo;s mind, probably because it&rsquo;s easy to grasp. Strangely, it looks like most forget the section &ldquo;Practical problems with replication&rdquo; on p27 of his paper, where you can understand that discrete replication is not all that practical.<!-- raw HTML omitted --><!-- raw HTML omitted -->Reflecting on all of this, I noticed it was possible to create more accurate discrete replications easily, and that those can have vastly different hedging weights. It is a much better idea to just replicate the log payoff continuously with a decent model for interpolation and extrapolation and imply the hedge from the greeks.<!-- raw HTML omitted --><!-- raw HTML omitted -->I wrote <!-- raw HTML omitted -->a small paper around this here<!-- raw HTML omitted -->.</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/gtk-3.0-gnome-3.0-annoyance/">GTK 3.0 / Gnome 3.0 annoyance</a>
  </h1>
  <time datetime="2015-02-08T22:30:00Z" class="post-date">Sun, Feb 8, 2015</time>
  <p>It&rsquo;s quite incredible that Gnome 3.0 was almost an identical mess as KDE 4.0 had been a year or two earlier. Both are much better now, more stable, but both also still have their issues, and don&rsquo;t feel like a real improvement over Gnome 2.0 or KDE 3.5.<!-- raw HTML omitted --><!-- raw HTML omitted -->Now the main file manager for Gnome 3.0, Nautilus has buttons with nearly identical icons that mean vastly different things, one is a menu, the other is a list view. Also it does not integrate with other desktops well from a look and feel perpective, here is a screenshot under XFCE (KDE would not look better).The push for window buttons inside the toolbar makes for a funny looking window. In Gnome Shell, it&rsquo;s not much better, plus there are some windows with a dark theme and some with a standard theme all mixed together.<!-- raw HTML omitted --><!-- raw HTML omitted -->On the left is Caja: an updated GTK 2.0 version of Nautilus. I find it more functional, I don&rsquo;t really understand the push to remove most options from the screen in Gnome 3.0. The only positive thing I can see on for the new Nautilus, is the grey color for the left side, which looks more readable and polished.<!-- raw HTML omitted --><!-- raw HTML omitted -->Interestingly, Nautilus within Ubuntu Unity feels better, it has a real menu and standard looking window. I suppose they customized it quite a bit. <!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->When it comes to HiDPI support, Gnome shell is often touted has having one of the best. Well maybe for laptop screens, but certainly not for larger screens, where it just double everything and everything just looks too big. XFCE is actually decent on HiDPI screens.</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/monte-carlo-inverse-cumulative-normal-distribution/">Monte Carlo &amp; Inverse Cumulative Normal Distribution</a>
  </h1>
  <time datetime="2015-02-03T14:53:00Z" class="post-date">Tue, Feb 3, 2015</time>
  <p>In most financial Monte-Carlo simulations, there is the need of generating normally distributed random numbers. One technique is to use the inverse cumulative normal distribution function on uniform random numbers. There are several different popular numerical implementations:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Wichura AS241 (1988)<!-- raw HTML omitted --><!-- raw HTML omitted -->Moro &ldquo;The full Monte&rdquo; (1995)<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Acklam<!-- raw HTML omitted --> (2004)<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Shaw breakless formula<!-- raw HTML omitted --> optimized for GPUs (2011) <!-- raw HTML omitted --><!-- raw HTML omitted -->W. Shaw has an excellent overview of the accuracy of the various methods in his paper <!-- raw HTML omitted --><!-- raw HTML omitted -->Refinement of the normal quantile<!-- raw HTML omitted --><!-- raw HTML omitted -->.<!-- raw HTML omitted --><!-- raw HTML omitted -->But what about performance? In Monte-Carlo, we could accept a slighly lower accuracy for an increase in performance.<!-- raw HTML omitted --><!-- raw HTML omitted -->I tested the various methods on the Euler full truncation scheme for Heston using a small timestep (0.01). Here are the results with Sobol quasi-rng:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->AS241          0.9186256922511046 0.42s<!-- raw HTML omitted -->MORO           0.9186256922459066 0.38s<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ACKLAM         0.9186256922549364 0.40s<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ACKLAM REFINED 0.9186256922511045 2.57s<!-- raw HTML omitted -->SHAW-HYBRID    0.9186256922511048 0.68s<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->In practice, the most accurate algorithm, AS241, is of comparable speed as the newer but less accurate algorithms of MORO and ACKLAM. Acklam refinement to go to double precision (which AS241 is) kills its performance.<!-- raw HTML omitted --><!-- raw HTML omitted -->What about the Ziggurat on pseudo rng only? Here are the results with Mersenne-Twister-64, and using the Doornik implementation of the Ziggurat algorithm:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->AS241  0.9231388565879476  0.49s<!-- raw HTML omitted -->ZIGNOR 0.9321405648313437  0.44s<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->There is a more optimized algorithm, VIZIGNOR, also from Doornik which should be a bit faster. As expected, the accuracy is quite lower than with Sobol, and the Ziggurat looks worse. This is easily visible if one plots the implied volatilities as a function of the spot for AS241 and for ZIGNOR.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->AS241 implied volatility on Mersenne-Twister<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ZIGNOR implied volatility on Mersenne-Twister<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Zignor is much noisier.<!-- raw HTML omitted --><!-- raw HTML omitted -->Note the slight bump in the scheme EULER-FT-BK that appears because the scheme, that approximates the Broadie-Kaya integrals with a trapeze (as in Andersen QE paper), does not respect martingality that well compared to the standard full truncated Euler scheme EULER-FT, and the slightly improved EULER-FT-MID where the variance integrals are approximated by a trapeze as in Van Haastrecht paper on Schobel-Zhu:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->This allows to leak less correlation than the standard full truncated Euler.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/local-stochastic-volatility-particles-and-bins/">Local Stochastic Volatility - Particles and Bins</a>
  </h1>
  <time datetime="2015-01-30T12:03:00Z" class="post-date">Fri, Jan 30, 2015</time>
  <p>In an <!-- raw HTML omitted -->earlier post<!-- raw HTML omitted -->, I mentioned the similarities between the Guyon-Labordere <!-- raw HTML omitted -->particle method<!-- raw HTML omitted --> and the Vanderstoep-Grzelak-Oosterlee <!-- raw HTML omitted -->&ldquo;bin&rdquo; method<!-- raw HTML omitted --> to calibrate and price under Local Stochastic volatility. I will be a bit more precise here.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The same thing, really<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The particle method can be seen as a generalization of the &ldquo;bin&rdquo; method. In deed, the bin method consists in doing the particle method using a histogram estimation of the conditional variance. The histogram estimation can be more or less seen as a very basic rectangle kernel with the appropriate bandwidth. The &ldquo;bin&rdquo; method is then just the particle method with another kernel (wiki link) (in the particle method, the kernel is a quartic with bandwidth defined by some slightly elaborate formula). A very good paper on this is Silverman <!-- raw HTML omitted --><!-- raw HTML omitted -->Density estimation for statistics and data analysis<!-- raw HTML omitted --><!-- raw HTML omitted -->, referenced by Guyon-Labordere.<!-- raw HTML omitted --><!-- raw HTML omitted -->In theory, the original particle method has the advantage of using a narrower bandwidth, resulting in a theoretical increase in performance as one does not have to sum over all particles, while providing a more local therefore precise estimate. In practice, the performance advantage is not so clear on my non optimized code.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Two-pass<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->There is an additional twist in the particle method: one can compute the expectation and the payoff evaluation in the same Monte-Carlo simulation, or in two sequential Monte-Carlo simulations.<!-- raw HTML omitted --><!-- raw HTML omitted -->Why would we do two? Mainly because the expectation is computed across all paths, at each time step, while, usually, payoff evaluation requires a full path as it will need to store some state at each observation time for path-dependent payoffs.<!-- raw HTML omitted --><!-- raw HTML omitted -->We can avoid recomputing the paths by just caching them at each observation time. The problem is that the size of this cache can quickly become extremely large and blow up the memory. For example a 10y daily knock-out will require 10 * 252 * 8 * 2 * MB = 40 GB for 1 million paths.<!-- raw HTML omitted --><!-- raw HTML omitted -->A side effect of the second simulation is that one can use a Quasi-Random number generator there, while for the first simulation, this is not easy as we compute all paths, dimension by dimension.<!-- raw HTML omitted --><!-- raw HTML omitted -->In practice, both methods work well, particle or bins, single-pass or two-pass. Here is a graph of the error in volatility, SV is a not so well calibrated Heston to market data. LVSV are the local stochastic volatility simulations, using as Vanderstoep 100 steps per year and 500K simulations with 30 bins.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->The advantages of the particle do not show up in terms of accuracy on this example.<!-- raw HTML omitted -->I have also noticed that short expiries seem trickier, the error being larger. This might just be due to the time-step size, but interestingly the papers only show graphs of medium (min=6m) to large expiries.</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/flat-volatility-surfaces-discrete-dividends/">Flat Volatility Surfaces &amp; Discrete Dividends</a>
  </h1>
  <time datetime="2014-11-25T13:58:00Z" class="post-date">Tue, Nov 25, 2014</time>
  <p>In papers around volatility and cash (discrete) dividends, we often encounter the example of the flat volatility surface. For example, the <!-- raw HTML omitted -->OpenGamma paper<!-- raw HTML omitted --> presents this graph:<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->It shows that if the Black volatility surface is fully flat, there are jumps in the pure volatility surface (corresponding to a process that includes discrete dividends in a consistent manner) at the dividend dates or equivalently if the pure volatility surface is flat, the Black volatility jumps.<!-- raw HTML omitted --><!-- raw HTML omitted -->This can be traced to the fact that the Black formula does not respect C(S,K,Td-) = C(S,K-d,Td) as the forward drops from F(Td-) to F(Td-)-d where d is dividend amount at td, the dividend ex date.<!-- raw HTML omitted --><!-- raw HTML omitted -->Unfortunately, those examples are not very helpful. In practice, the market observables are just Black volatility points, which can be interpolated to volatility slices for each expiry without regards to dividends, not a full volatility surface. Discrete dividends will mostly happen between two slices: the Black volatility jump will happen on some time-interpolated data.<!-- raw HTML omitted --><!-- raw HTML omitted -->While the jump size is known (it must obey to the call price continuity), the question of how one should interpolate that data until the jump is far from trivial even using two flat Black volatility slices.<!-- raw HTML omitted --><!-- raw HTML omitted -->The most logical is to consider a model that includes discrete dividends consistently. For example, one can fully lookup the Black volatility corresponding the price of an option assuming a piecewise lognormal process with jumps at the dividend dates. It can be priced by applying a finite difference method on the PDE. Alternatively, <!-- raw HTML omitted -->Bos &amp; Vandermark<!-- raw HTML omitted --> propose a simple spot and strike adjusted Black formula that obey the continuity requirement (the Lehman model), which, in practice, stays quite close to the piecewise lognormal model price. Another possibility is to rely on a forward modelling of the dividends, as in <!-- raw HTML omitted -->Buehler<!-- raw HTML omitted --> (if one is comfortable with the idea that the option price will then depend ultimately on dividends past the option expiry).<!-- raw HTML omitted --><!-- raw HTML omitted -->Recently, a <!-- raw HTML omitted -->Wilmott article<!-- raw HTML omitted --> suggested to only rely on the jump adjustment, but did not really mention how to find the volatility just before or just after the dividend. Here is an illustration of how those assumptions can change the volatility in between slices using two dividends at T=0.9 and T=1.1.<!-- raw HTML omitted --><!-- raw HTML omitted -->In the first graph, we just interpolate linearly in forward moneyness the pure vol from the Bos &amp; Vandermark formula, as it should be continuous with the forward (the PDE would give nearly the same result) and compute the equivalent Black volatility (and thus the jump at the dividend dates).<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->In the second graph, we interpolate linearly the two Black slices, until we find a dividend, at which point we impose the jump condition and repeat the process until the next slice. We process forward (while the Wilmott article processes backward) as it seemed a bit more natural to make the interpolation not depend on future dividends. Processing backward would just make the last part flat and first part down-slopping. On this example backward would be closer to the Bos Black volatility, but when the dividends are near the first slice, the opposite becomes true.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->While the scale of those changes is not that large on the example considered, the choice can make quite a difference in the price of structures that depend on the volatility in between slices. A recent example I encountered is the variance swap when one includes adjustment for discrete dividends (then the prices just after the dividend date are used).<!-- raw HTML omitted --><!-- raw HTML omitted -->To conclude, if one wants to use the classic Black formula everywhere, the volatility must jump at the dividend dates. Interpolation in time is then not straightforward and one will need to rely on a consistent model to interpolate. It is not exactly clear then why would anyone stay with the Black formula except familiarity.</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/machine-learning-quantitative-finance/">Machine Learning &amp; Quantitative Finance</a>
  </h1>
  <time datetime="2014-11-18T12:34:00Z" class="post-date">Tue, Nov 18, 2014</time>
  <p>There is an interesting course on <!-- raw HTML omitted -->Machine Learning on Coursera<!-- raw HTML omitted -->, it does not require much knowledge and yet manages to teach quite a lot.<!-- raw HTML omitted --><!-- raw HTML omitted -->I was struck by the fact that most techniques and ideas apply also to problems in quantitative finance.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Linear regression<!-- raw HTML omitted -->: used for example in the Longstaff-Schwartz approach to price Bermudan options with Monte-Carlo. Interestingly the teacher insists on feature normalization, something we can forget easily, especially with the polynomial features.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Gradient descent<!-- raw HTML omitted -->: one of the most basic minimizer and we use minimizers all the time for model calibration.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Regularization<!-- raw HTML omitted -->: in finance, this is sometimes used to smooth out the volatility surface, or can be useful to add stability in calibration. The lessons are very practical, they explain well how to find the right value of the regularization parameter.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Neural networks<!-- raw HTML omitted --><!-- raw HTML omitted -->: calibrating a model is very much like training a neural network. The <!-- raw HTML omitted --><!-- raw HTML omitted -->backpropagation<!-- raw HTML omitted --><!-- raw HTML omitted --> is the same thing as the adjoint differentiation. It&rsquo;s very interesting to see that it is a key feature for  Neural networks, otherwise training would be much too slow and Neural networks would not be practical. Once the network is trained, it is evaluated relatively quickly forward. It&rsquo;s basically the same thing as calibration and then pricing.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->Support vector machines<!-- raw HTML omitted -->: A gaussian kernel is often used to represent the frontier. We find the same idea in the particle Monte-Carlo method.<!-- raw HTML omitted --><!-- raw HTML omitted -->Principal component analysis: can be applied to the covariance matrix square root in Monte-Carlo simulations, or to &ldquo;compress&rdquo; large baskets, as well as for portfolio risk.<!-- raw HTML omitted --><!-- raw HTML omitted -->It&rsquo;s also interesting to hear the teacher repeating that people should not try possible improvements at random (often because they have only one idea) but analyze before what makes the most sense. And that can imply digging in the details, looking at what&rsquo;s going on 100 samples.<!-- raw HTML omitted --><!-- raw HTML omitted -->While it sounds like a straightforward remark, I have found that people (including myself) tend to do the same mistakes in finance. We might use some quadrature, find out it does not perform that well in some cases, replace it with another one that behaves a bit better, without investigating the real issue: why does the first quadrature break? is the new quadrature really fixing the issue?</p>

  
</article>
</div>
<p style="text-align:left; width:49%; display: inline-block;"><a href="/page/7/">Previous</a></p>
<p style="text-align:right; width:50%;  display: inline-block;"><a href="/page/9/">Next</a></p>
    </main>

    
      
    
  </body>
</html>
