<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.101.0" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Chase the Devil</title>
  <meta name="description" content="A personal, independent, technical blog" />

  
  <link type="text/css" rel="stylesheet" href="https://chasethedevil.github.io/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://chasethedevil.github.io/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://chasethedevil.github.io/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://chasethedevil.github.io/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">
<link href="https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&display=swap" rel="stylesheet">
 <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="https://chasethedevil.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Chase the Devil" />
  <script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

</head>

  <body class=" ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://chasethedevil.github.io/"><h1 style="font-family: 'UnifrakturMaguntia', cursive;font-weight: normal;">Chase the Devil</h1></a>
      <p class="lead">
       A personal, independent, technical blog 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://chasethedevil.github.io/">Blog</a> </li>
        <li><a href="/about/"> About </a></li><li><a href="/post/"> Posts </a></li><li><a href="/tags/"> Tags </a></li>
      </ul>

        <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <script type="text/javascript">document.write("<a href=\"mail" + "to:" + new Array("fabien","2ipi.com").join("@") + "?subject=your%20blog\">" + '<i class="fa fa-envelope fa-3x"></i>' + "</" + "a>");</script>
      
      
      
      
      
      
      <a href="https://twitter.com/logos01"><i class="fa fa-twitter-square fa-3x"></i></a>
      
      <a href="https://chasethedevil.github.io/index.xml" type="application/rss+xml"><i class="fa fa-rss-square fa-3x"></i></a>
      </li>
    </ul>
 </nav>

    <p>&copy; 2023. All rights reserved. </p>
  </div>
</aside>

    <main class="content container">
    <div class="posts">
<article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/benham_disc_in_web_canvas/">Benham disc in web canvas</a>
  </h1>
  <time datetime="2017-07-10T23:56:42&#43;0100" class="post-date">Mon, Jul 10, 2017</time>
  <p>Around 15 years ago, I wrote a small Java applet to try and show the <a href="https://en.wikipedia.org/wiki/Benham%27s_top">Benham disk</a> effect. Even back then applets were already passé and Flash would have been more appropriate. These days, no browser support Java applets anymore, and very few web users have Java installed. Flash also mostly disappeared. The <a href="https://www.w3schools.com/html/html5_canvas.asp">web canvas</a> is today&rsquo;s standard allowing to embbed animations in a web page.
 

This effect shows color perception from a succession of black and white pictures. It is a computer reproduction from the Benham disc with ideas borrowed from "Pour La Science Avril/Juin 2003".
Using a delay between 40 and 60ms, the inner circle should appear <font color="#770000">red</font>, the one in the middle 
<font color="#000077">blue</font> and the outer one <font color="#007700">green</font>. When you reverse the rotation direction,
blue and red circles should be inverted.

<form>
  Delay: <input type="number" name="delay" value="60" id="delayInput"> Reverse <input type="checkbox" value="false" id="reverseInput" onclick="javascript:reverse()"> <input type="button" value="Start" onclick="javascript:startStop()" id="startButton">
</form>

<canvas id="myCanvas" width="480" height="480" style="border:1px solid #000000;">
</canvas> 

<script type="text/javascript">
var c = document.getElementById("myCanvas");
  c.style.width ='100%';
  c.style.height='100%';
  // ...then set the internal size to match
  c.width  = c.offsetWidth;
  c.height = c.offsetWidth;
var x=c.width/2;
var y=x;
linewidth = c.width / 100;
var g = c.getContext("2d");

function paintImage(g, x,y,startArcAngle) {
var radius = 0.9;
var r = radius*x; endAngle = 2*Math.PI/3+startArcAngle;
g.beginPath();
g.arc(x, y, r, Math.PI/3+startArcAngle, endAngle, false);
g.lineWidth = linewidth;
g.strokeStyle = "black";
g.stroke();

radius = 0.8; r = radius*x;
g.beginPath();
g.arc(x, y, r + 1, Math.PI/3+startArcAngle, endAngle, false);
g.stroke();

radius = 0.7; r = radius*x;
g.beginPath();
g.arc(x, y, r + 1, Math.PI/3+startArcAngle, endAngle, false);
g.stroke();

radius = 0.6; r = radius*x; endAngle = Math.PI/3+startArcAngle;
g.beginPath();
g.arc(x, y, r + 1, 0+startArcAngle, endAngle, false); 
g.stroke();

radius = 0.5; r = radius*x;
g.beginPath();
g.arc(x, y, r + 1, 0+startArcAngle, endAngle, false); 
g.stroke();

radius = 0.4; r = radius*x;
g.beginPath();
g.arc(x, y, r + 1, 0+startArcAngle, endAngle, false);
g.stroke();

//  paintImage(g, startArcAngle, 60, 0.3); //red -180 to -60
radius = 0.3; r = radius*x; endAngle = Math.PI+startArcAngle;// if (endAngle > Math.PI*2) endAngle = endAngle - 2*Math.PI 
g.beginPath();
g.arc(x, y, r + 1,  2*Math.PI/3+startArcAngle, endAngle, false); 
g.stroke();
        
radius = 0.2; r = radius*x;
g.beginPath();
g.arc(x, y, r + 1,  2*Math.PI/3+startArcAngle, endAngle, false); 
g.stroke();

radius = 0.1; r = radius*x;
g.beginPath();
g.arc(x, y, r + 1,  2*Math.PI/3+startArcAngle, endAngle, false); 
g.stroke();

g.beginPath();
g.arc(x, y, x,  Math.PI+startArcAngle, Math.PI*2+startArcAngle, false); 
g.fill();
}

var delay = 40;
var currentAnimate = 0;
var animationStartTime = window.performance.now();
var currentIndex = 3;
var angles = [0.0, 2*Math.PI/3, 4*Math.PI/3];

var offscreenCanvas = [document.createElement('canvas'),document.createElement('canvas'),document.createElement('canvas')];
for (var i in offscreenCanvas) {
  offscreenCanvas[i].width = c.offsetWidth;
  offscreenCanvas[i].height = c.offsetWidth;
  g = offscreenCanvas[i].getContext("2d");
  paintImage(g, x, y, angles[i]);
}
g = c.getContext("2d");

//function animate0() {
//  g.clearRect(0,0,c.width, c.height);
//  paintImage(g,x, y,  0.0);
//  currentAnimate = setTimeout(animate1, delay);
//}
//function animate1() {
//  g.clearRect(0,0,c.width, c.height);
//  paintImage(g,x, y,  2*Math.PI/3);
//  currentAnimate = setTimeout(animate2, delay);
//}
//function animate2() {
//  g.clearRect(0,0,c.width, c.height);
//  paintImage(g,x, y, 4*Math.PI/3);
//  currentAnimate= setTimeout(animate0, delay);
//}

window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame ||
                              window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;


function animateContinuous(time) {
  var index = Math.floor(((time - animationStartTime) % (3*delay))/delay);
  if (index < 0) index = 0
  if (index != currentIndex) {
    //g.clearRect(0,0,c.width, c.height);
    //paintImage(g, x, y, angles[index]);
    var offscreenContext = offscreenCanvas[index].getContext('2d');
    var image = offscreenContext.getImageData(0,0,c.width,c.height); 
    g.putImageData(image, 0, 0);       
    currentIndex = index;
  }
  currentAnimate = requestAnimationFrame(animateContinuous);
}

function reverse() {
  //tmp = angles[2]; angles[2] = angles[0]; angles[0] = tmp;
  tmp = offscreenCanvas[2]; offscreenCanvas[2] = offscreenCanvas[0]; offscreenCanvas[0] = tmp;
}

function startStop() {
  var elem = document.getElementById("startButton");
  var delayElem = document.getElementById("delayInput");
 if (elem.value=="Stop") {
    elem.value = "Start";
    //clearTimeout(currentAnimate);
    window.cancelAnimationFrame(currentAnimate);
    currentAnimate = 0;
  } else {
    elem.value = "Stop";
    delay = delayElem.value;
    animationStartTime = window.performance.now();
    //animate0();
    currentAnimate = requestAnimationFrame(animateContinuous);
  }
}
</script>

</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/quantitative_finance_blogs/">Blogs on Quantitative Finance</a>
  </h1>
  <time datetime="2017-06-21T23:56:42&#43;0100" class="post-date">Wed, Jun 21, 2017</time>
  <p>There are not many blogs on quantitative finance that I read. Blogs are not so popular anymore with the advent of the various social networks (facebook, stackoverflow, google plus, reddit, &hellip;). Here is a small list:</p>
<ul>
<li><a href="https://www.clarusft.com/blog/">Clarus FT</a>: often interesting statistics on the swap market, clearing, plus the <a href="https://www.clarusft.com/author/gary/">more technical articles from Gary</a>.</li>
<li><a href="https://quantsrus.github.io/">Quants R Us</a>: A relatively new blog with a promising starting post analyzing <a href="https://quantsrus.github.io/post/andreasen_huge_spline/">Andreasen-Huge one-step local-volatility algorithm with a Spline</a></li>
<li><a href="https://quantlib.wordpress.com/author/petercaspers/">Fooling around with Quantlib</a>: the blog from Peter Caspers, also relevant  to non-Quantlib professionals has original insights such as <a href="https://quantlib.wordpress.com/2015/09/19/smile-dynamics-by-densities/">Smile dynamics by densities</a> or the <a href="https://quantlib.wordpress.com/2015/08/23/supernatural-libor-coupons/">Supernatural Libor Coupons</a>. Unfortunately it is not so active anymore.</li>
<li><a href="http://www.implementingquantlib.com">Implementing Quantlib</a>: the blog from Luigi Ballabio, which explains many of the design decisions in Quantlib. Very interesting for developer of financial libraries, see for example <a href="http://www.implementingquantlib.com/2017/04/fd-solvers.html">the fd solvers</a>.</li>
<li><a href="https://hpcquantlib.wordpress.com/">HPC Quantlib</a> from Klaus Spanderen. Yes lots of quantlib blogs, but this one is actually not much focused on quantlib. It goes into great details about some numerical techniques, see for example the <a href="https://hpcquantlib.wordpress.com/2017/05/07/newer-semi-analytic-heston-pricing-algorithms/">analysis of Heston pricing algorithm</a></li>
<li><a href="http://oxfordstrat.com/rd-blog/">Oxford Strat</a>. It is a different kind of subject: too many trading strategies but some interesting data, for example <a href="http://oxfordstrat.com/data/global-market-correlations/">global market correlations</a> and <a href="http://oxfordstrat.com/ideas/sharpe-ratio/">ideas</a>.</li>
<li><a href="https://forum.wilmott.com/">Wilmott forums</a> not a blog, but it sometimes (not often) has interesting discussions and can be a good way to connect.</li>
</ul>
<p>Another way to find out what&rsquo;s going on in the quantitative finance world is to scan regularly recent papers on <a href="https://arxiv.org/list/q-fin/recent">arxiv</a>, <a href="http://www.ssrn.com">SSRN</a> or the suggestions of <a href="http://scholar.google.com">Google scholar</a>.</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/typo-in-hyman-non-negative-constraint/">Typo in Hyman non-negative constraint - 28 years later</a>
  </h1>
  <time datetime="2017-05-23T23:56:42&#43;0100" class="post-date">Tue, May 23, 2017</time>
  <p>In their paper <a href="http://www.ams.org/journals/mcom/1989-52-186/S0025-5718-1989-0962209-1/S0025-5718-1989-0962209-1.pdf">&ldquo;Nonnegativity-, Monotonicity-, or Convexity-Preserving Cubic and Quintic Hermite Interpolation&rdquo;</a>, Dougherty, Edelman and Hyman present a simple filter on the first derivatives to maintain positivity of a cubic spline interpolant.</p>
<p>Unfortunately, in their main formula for non-negativity, they made a typo: the equation (3.3) is not consistent with the equation (3.1): the  \( \Delta x_{i-1/2} \)  is interverted with  \( \Delta x_{i+1/2} \).</p>
<p>It was not obvious to find out which equation was wrong since there is no proof in the paper. Fortunately, the proof is in the reference paper <a href="http://epubs.siam.org/doi/abs/10.1137/0722023">&ldquo;Monotone piecewise bicubic interpolation&rdquo;</a> from Carlson and Fritsch and it is clear then that equation (3.1) is the correct one.</p>
<p>Here is a counter example for equation (3.3) for a Hermite cubic spline with natural boundary conditions
 

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span>	x <span style="color: #666666">:=</span> []<span style="color: #902000">float64</span>{<span style="color: #666666">-</span><span style="color: #40a070">2.427680355823974</span>, <span style="color: #666666">-</span><span style="color: #40a070">2.3481443181227126</span>, <span style="color: #666666">-</span><span style="color: #40a070">2.268608280421452</span>, <span style="color: #666666">-</span><span style="color: #40a070">2.189072242720191</span>, <span style="color: #666666">-</span><span style="color: #40a070">2.1095362050189297</span>, <span style="color: #666666">-</span><span style="color: #40a070">2.0300001673176684</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.9504641296164076</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.8709280919151465</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.7913920542138855</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.7118560165126244</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.6323199788113634</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.5527839411101023</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.4732479034088413</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.3937118657075802</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.3141758280063192</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.234639790305058</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.155103752603797</span>, <span style="color: #666666">-</span><span style="color: #40a070">1.075567714902536</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.996031677201275</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.9164956395000139</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.8369596017987528</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.7574235640974918</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.6778875263962307</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.5983514886949697</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.5188154509937086</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.4392794132924476</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.3597433755911865</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.28020733788992525</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.20067130018866441</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.12113526248740358</span>, <span style="color: #666666">-</span><span style="color: #40a070">0.04159922478614231</span>, <span style="color: #40a070">0.03793681291511897</span>, <span style="color: #40a070">0.1174728506163798</span>, <span style="color: #40a070">0.19700888831764063</span>, <span style="color: #40a070">0.2765449260189019</span>, <span style="color: #40a070">0.3560809637201632</span>, <span style="color: #40a070">0.435617001421424</span>, <span style="color: #40a070">0.5151530391226848</span>, <span style="color: #40a070">0.5946890768239461</span>, <span style="color: #40a070">0.6742251145252074</span>, <span style="color: #40a070">0.7537611522264682</span>}
y <span style="color: #666666">:=</span> []<span style="color: #902000">float64</span>{<span style="color: #40a070">0.22303659708933243</span>, <span style="color: #40a070">0.22655584607177778</span>, <span style="color: #40a070">0.16305913092318047</span>, <span style="color: #40a070">0.10448859033589929</span>, <span style="color: #40a070">0.16002349837315494</span>, <span style="color: #40a070">0.15632461201014838</span>, <span style="color: #40a070">0.20216975718723287</span>, <span style="color: #40a070">0.15780097999496998</span>, <span style="color: #40a070">0.1293436080647528</span>, <span style="color: #40a070">0.13101037880853464</span>, <span style="color: #40a070">0.13496819587884762</span>, <span style="color: #40a070">0.1241082758487616</span>, <span style="color: #40a070">0.13677319399415233</span>, <span style="color: #40a070">0.11493379360854317</span>, <span style="color: #40a070">0.10181073092072719</span>, <span style="color: #40a070">0.10390553149978735</span>, <span style="color: #40a070">0.09705141597989163</span>, <span style="color: #40a070">0.09469310717587004</span>, <span style="color: #40a070">0.09397968424452849</span>, <span style="color: #40a070">0.08115526370674754</span>, <span style="color: #40a070">0.07021707117654993</span>, <span style="color: #40a070">0.07896827656600293</span>, <span style="color: #40a070">0.0733165278111029</span>, <span style="color: #40a070">0.06626131630031683</span>, <span style="color: #40a070">0.06036157053511007</span>, <span style="color: #40a070">0.05598416466538939</span>, <span style="color: #40a070">0.049613807117723785</span>, <span style="color: #40a070">0.04821691404672292</span>, <span style="color: #40a070">0.04274830629369516</span>, <span style="color: #40a070">0.04053002586588819</span>, <span style="color: #40a070">0.03690680495068648</span>, <span style="color: #40a070">0.03232925805830648</span>, <span style="color: #40a070">0.02686034599416645</span>, <span style="color: #40a070">0.02152456554605186</span>, <span style="color: #40a070">0.01281016667726421</span>, <span style="color: #40a070">0.005672278716525797</span>, <span style="color: #40a070">0.0021938540693167367</span>, <span style="color: #40a070">0.0015582304062002356</span>, <span style="color: #40a070">0.0002050615897307207</span>, <span style="color: #40a070">3.232807285235909e-07</span>, <span style="color: #40a070">4.059553937573009e-06</span>}
z <span style="color: #666666">:=</span> <span style="color: #40a070">0.7410184269884271</span>
</pre></div>

</p>
<p>In the above example, even though the step size \(\Delta x\) is constant, the error is visible at the last node since then only one inequation apply, and it will be different with the typo.</p>
<p>It is quite annoying to stumble upon such typos, especially when the equations stem from a derived correct paper. We wonder then where are the other typos in the paper and our trust in the equations is greatly weakened. Unfortunately, such mistakes happen to everybody, including myself, and they are rarely caught by reviewers.</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/implied-volatility-from-black-scholes-price/">Implied Volatility from Black-Scholes price</a>
  </h1>
  <time datetime="2017-04-02T07:56:42&#43;0100" class="post-date">Sun, Apr 2, 2017</time>
  <p>Dan Stefanica and Rados Radoicic propose a quite good initial guess in their very recent paper <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2908494">An Explicit Implied Volatility Formula</a>. Their formula is simple, fast to compute and results in an implied volatility guess with a relative error of less than 10%.</p>
<p>It is more robust than the rational fraction from <a href="https://mpra.ub.uni-muenchen.de/6867/1/MPRA_paper_6867.pdf">Minquiang Li</a>: his rational fraction is only valid for a fixed range of strikes and maturities. The new approximation is mathematically proved accurate across all strikes and all maturities. There is only the need to be careful in the numerical implementation with the case where the price is very small (a Taylor expansion of the variable C will be useful in this case).</p>
<p>As mentioned in an <a href="/post/fast-and-accurate-implied-volatility-solver/">earlier post</a>, Peter Jäckel solved the real problem by providing the code for a fast, very accurate and robust solver along with his paper <a href="http://jaeckel.16mb.com/LetsBeRational.pdf">Let&rsquo;s be rational</a>. This new formula used as initial guess to Minquiang Li SOR-TS solver provides an interesting alternative: the resulting code is very simple and efficient. The accuracy, relative or absolute can be set to eventually speedup the calculation.</p>
<p>Below is an example of the performance on a few different cases for strike 150, forward 100, time to maturity 1.0 year and a relative tolerance of 1E-8 using <a href="https://golang.org/">Go 1.8</a>.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Original volatility</th>
<th style="text-align:center">Method</th>
<th style="text-align:left">Implied Volatility</th>
<th style="text-align:right">Time</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">64%</td>
<td style="text-align:center">Jäckel</td>
<td style="text-align:left">0.6400000000000002</td>
<td style="text-align:right">1005 ns</td>
</tr>
<tr>
<td style="text-align:center">64%</td>
<td style="text-align:center">Rational</td>
<td style="text-align:left">0.6495154924570236</td>
<td style="text-align:right">72 ns</td>
</tr>
<tr>
<td style="text-align:center">64%</td>
<td style="text-align:center">SR</td>
<td style="text-align:left">0.6338265040549524</td>
<td style="text-align:right">200 ns</td>
</tr>
<tr>
<td style="text-align:center">64%</td>
<td style="text-align:center">Rational-Li</td>
<td style="text-align:left">0.6400000010047917</td>
<td style="text-align:right">436 ns</td>
</tr>
<tr>
<td style="text-align:center">64%</td>
<td style="text-align:center">SR-Li</td>
<td style="text-align:left">0.6400000001905617</td>
<td style="text-align:right">568 ns</td>
</tr>
<tr>
<td style="text-align:center">16%</td>
<td style="text-align:center">Rational</td>
<td style="text-align:left">0.1575005551326285</td>
<td style="text-align:right">72 ns</td>
</tr>
<tr>
<td style="text-align:center">16%</td>
<td style="text-align:center">SR</td>
<td style="text-align:left">0.15117970813645165</td>
<td style="text-align:right">200 ns</td>
</tr>
<tr>
<td style="text-align:center">16%</td>
<td style="text-align:center">Jäckel</td>
<td style="text-align:left">0.16000000000000025</td>
<td style="text-align:right">1323 ns</td>
</tr>
<tr>
<td style="text-align:center">16%</td>
<td style="text-align:center">Rational-Li</td>
<td style="text-align:left">0.16000000000219483</td>
<td style="text-align:right">714 ns</td>
</tr>
<tr>
<td style="text-align:center">16%</td>
<td style="text-align:center">SR-Li</td>
<td style="text-align:left">0.16000000000018844</td>
<td style="text-align:right">1030 ns</td>
</tr>
<tr>
<td style="text-align:center">4%</td>
<td style="text-align:center">Rational</td>
<td style="text-align:left">0.1528010258201771</td>
<td style="text-align:right">72 ns</td>
</tr>
<tr>
<td style="text-align:center">4%</td>
<td style="text-align:center">SR</td>
<td style="text-align:left">0.043006234681405076</td>
<td style="text-align:right">190 ns</td>
</tr>
<tr>
<td style="text-align:center">4%</td>
<td style="text-align:center">Jäckel</td>
<td style="text-align:left">0.03999999999999886</td>
<td style="text-align:right">1519 ns</td>
</tr>
<tr>
<td style="text-align:center">4%</td>
<td style="text-align:center">Rational-Li</td>
<td style="text-align:left">0.040000000056277685</td>
<td style="text-align:right">10235 ns</td>
</tr>
<tr>
<td style="text-align:center">4%</td>
<td style="text-align:center">SR-Li</td>
<td style="text-align:left">0.040000000000453895</td>
<td style="text-align:right">2405 ns</td>
</tr>
</tbody>
</table>
<p>The case 4% was an example of a particularly challenging setting in a <a href="https://forum.wilmott.com/viewtopic.php?f=34&amp;t=97812&amp;start=75">Wilmott forum</a>. It results in a very small call option price (9E-25).</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/vix-starts-smiling/">The VIX starts smiling</a>
  </h1>
  <time datetime="2017-03-21T07:56:42&#43;0100" class="post-date">Tue, Mar 21, 2017</time>
  <p>The VIX implied volatilities used to look like a logarithmic function of the strikes. I don&rsquo;t look at them often, but today, I noticed that the VIX had the start of a smile shape.</p>
<figure><img src="/post/vix_smile.png"/><figcaption>
            <h4>1m VIX implied volatilities on March 21, 2017 with strictly positive volume.</h4>
        </figcaption>
</figure>

<p>Very few strikes trades below the VIX future level (12.9). All of this is likely because the VIX is unusually low: not many people are looking to trade it much lower.</p>
<p><strong>Update March 22:</strong> Actually the smile in VIX is not particularly new, it is visible in Jim Gatheral 2013 presentation <a href="https://www.google.fr/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwiF2LP9turSAhUJVBQKHUVFCIoQFggoMAA&amp;url=http%3A%2F%2Fmfe.baruch.cuny.edu%2Fwp-content%2Fuploads%2F2012%2F09%2FBeijingSPXVIX2013.pdf&amp;usg=AFQjCNHCx2b2AXNXPHixUAYQC2nWH9ULHQ">Joint modeling of SPX and VIX</a> for the short maturities. Interestingly, <a href="/post/when-svi-breaks-down/">the issue with SVI</a> is also visible in those slides in the shortest maturity.</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/when-svi-breaks-down/">When SVI Breaks Down</a>
  </h1>
  <time datetime="2017-03-16T07:56:42&#43;0100" class="post-date">Thu, Mar 16, 2017</time>
  <p>In order to fit the implied volatility smile of equity options, one of the most popular parameterization is Jim Gatheral&rsquo;s SVI, which I have written about before <a href="/post/another-svi-initial-guess/">here</a>.</p>
<p>It turns out that in the current market conditions, SVI does not work well for short maturities. <a href="http://www.optionistics.com/quotes/stock-option-chains/SPX">SPX options</a> expiring on March 24, 2017 (one week) offer a good example. I paid attention to include only options with non zero volume, that is options that are actually traded.</p>
<figure><img src="/post/spxw_03242017.png"/><figcaption>
            <h4>SPXW implied volatilities on March 16, 2017 with strictly positive volume.</h4>
        </figcaption>
</figure>

<p>SVI does not fit well near the money (the SPX index is at 2385) and has an obviously wrong right wing. This is not due to the choice of weights used for the calibration (I used the volume as weight; equal weights would be even worse). Interestingly, SABR (with beta=1) does much better, even though it has two less parameters than SVI. Also a simple least squares parabola here does not work at all as it ends up fitting only the left wing.</p>
<p>If we include all options with non zero open interest and use ask/(bid-ask) weights, SVI is even worse:
<figure><img src="/post/spxw_03242017f.png"/><figcaption>
            <h4>SPXW implied volatilities on March 16, 2017 with strictly positive open interest.</h4>
        </figcaption>
</figure>
</p>
<p>We can do a bit better with SVI by squaring the weights and it shows the problem of SVI more clearly:
<figure><img src="/post/spxw_03242017f2.png"/><figcaption>
            <h4>SPXW implied volatilities on March 16, 2017 with strictly positive open interest and SVI weights squared.</h4>
        </figcaption>
</figure>
</p>
<p>These days, the VIX index is particularly low. Today, it is at 11.32. Usually, a low VIX translates to growing stocks as investors are confident in a low volatility environment. The catch with those extremely low ATM vols, is that the curvature is more pronounced, and so people are not so confident after all.</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/brownian-bridge-and-discrete-sampling/">Brownian Bridge and Discrete Random Variables</a>
  </h1>
  <time datetime="2017-01-26T14:55:32&#43;0100" class="post-date">Thu, Jan 26, 2017</time>
  <p>The <a href="/post/a-new-scheme-for-heston">new Heston discretisation scheme</a> I wrote about a few weeks ago makes use
a discrete random variable matching the first five moments of the normal distribution instead of the usual
normally distributed random variable, computed via the inverse cumulative distribution function. Their discrete random
variable is:
$$\xi =	\sqrt{1-\frac{\sqrt{6}}{3}} \quad \text{ if } U_1 &lt; 3,,$$
$$	\xi =-\sqrt{1-\frac{\sqrt{6}}{3}} \quad \text{ if } U_1 &gt; 4,,$$
$$\xi =	\sqrt{1+\sqrt{6}} \quad \text{ if } U_1 = 3,,$$
$$\xi =	-\sqrt{1+\sqrt{6}} \quad \text{ if } U_1 = 4,,$$
with \(U_1 \in \{0,1,&hellip;,7\}\)</p>
<p>The advantage of the discrete variable is that it is much faster to generate. But there are some interesting
side-effects. The first clue I found is a loss of accuracy on forward-start vanilla options.</p>
<p>By accident, I found a much more interesting side-effect: you can not use the Brownian-Bridge variance reduction
on the discrete random variable. This is very well illustrated by the case
of a digital option in the Black model, for example with volatility 10% and a 3 months maturity, zero interest rate and dividends. For the following graph,
I use 16000 Sobol paths composed of 100 time-steps.</p>
<figure><img src="/post/black_discrete_sampling.png"/><figcaption>
            <h4>Digital Call price with different random variables.</h4>
        </figcaption>
</figure>

<p>The &ldquo;-BB&rdquo; suffix stands for the Brownian-Bridge path construction, &ldquo;Five&rdquo; for five moments discrete variable
and &ldquo;AS241&rdquo; for the inverse cumulative distribution function (continuous approach). As you can see,
the price is discrete, and follows directly from the discrete distribution.
The use of any random number generator with a large enough number of paths would lead to the same conclusion.</p>
<p>This is because with the Brownian-Bridge technique, the last point in the path, corresponding to the maturity,
is sampled first, and the other path points are then completed inside from the first and last points.
But the digital option depends only on the value of the path at maturity, that is, on this last point.
As this point corresponds follows our discrete distribution, the price of the digital option is a step function.</p>
<p>In contrast, for the incremental path construction, each point is computed from the previous point.
The last point will thus include the variation of all points in the path, which will be very close to normal, even with a discrete distribution per point.</p>
<p>The take-out to price more exotic derivatives (including forward-start options) with discrete random variables
and the incremental path construction, is that several intermediate time-steps (between payoff observations)
are a must-have with discrete random variables, however small is the original time-step size.</p>
<p>Furthermore, one can notice the discrete staircase even with a relavely small time-step for example of 1/32 (meaning 8 intermediate time-steps in
our digital option example). I suppose this is a direct consequence of the digital payoff discontinuity. In Talay
<a href="http://link.springer.com/chapter/10.1007/BFb0006577">&ldquo;Efficient numerical schemes for the approximation of expectations of functionals of the solution of a SDE, and applications&rdquo;</a> (which you can
read by adding .sci-hub.cc to the URL host name), second order convergence
is proven only if the payoff function and its derivatives up to order 6 are continuous. There is something natural
that a discrete random variable imposes continuity conditions on the payoff, not necessary with a continuous,
smooth random variable: either the payoff or the distribution needs to be smooth.</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/samsung_wireless_printer_fedora25/">Samsung Wireless Printer under Fedora 25</a>
  </h1>
  <time datetime="2017-01-26T09:55:32&#43;0100" class="post-date">Thu, Jan 26, 2017</time>
  <p>This is a note for those who want to setup a Samsung wireless printer under Linux. It is quite simple,
<a href="https://ubuntuforums.org/showthread.php?t=2263245">this forum post</a> helped me, the actual useful steps on Fedora 25 are:</p>
<ul>
<li>download tar.gz linux driver from <a href="http://www.samsungsetup.com/">Samsung website</a>. As root, unpack &amp; install:</li>
</ul>
<pre tabindex="0"><code>tar xvzf SamsungPrinterInstaller.tar.gz 
cd uld
./install.sh
</code></pre><ul>
<li>in the printer menu, lookup for the wireless key (8 digits),</li>
<li>connect to the printer Wifi network with a computer using the wireless key,</li>
<li>enter the network gateway IP, this is typically <a href="http://192.168.3.1">http://192.168.3.1</a>,</li>
<li>click on Login with user &ldquo;admin&rdquo; and password &ldquo;sec00000&rdquo;,</li>
<li>open the network wifi settings and select &ldquo;Easy Wi-Fi Settings&rdquo;,</li>
<li>connect back to your wireless network,</li>
<li>add the network printer via the printer settings wizard, or alternatively through CUPS interface <a href="http://localhost:631">http://localhost:631</a>.</li>
</ul>
<p>That&rsquo;s it. Printer and scanner will then work on your local Wi-Fi network.</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/a-new-scheme-for-heston_part2/">A new scheme for Heston - Part 2</a>
  </h1>
  <time datetime="2017-01-23T07:55:32&#43;0100" class="post-date">Mon, Jan 23, 2017</time>
  <p>A couple weeks ago, I wrote about <a href="/post/a-new-scheme-for-heston">a new Heston discretisation scheme</a> which was at least as accurate as Andersen QE scheme and faster, called DVSS2.</p>
<p>It turns out that it does not behave very well on the following Vanilla forward start option example (which is quite benign).
The Heston parameters comes from a calibration to the market and are</p>
<p>$$v_0= 0.0718, \kappa= 1.542, \theta= 0.0762, \sigma= 0.582, \rho= -0.352$$</p>
<p>with a maturity of one year.</p>
<p>On a standard vanilla option, DVSS2 behaves as advertised in the paper but not on a forward-start option
with forward start date at \(T_1=\frac{7}{8}\) (relatively close to the maturity).
A forward start call option will pay \(\max(S(T)-k S(T_1),0)\).
This is particularly visible on the following graph of the price against
the time-step size (1,1/2,1/4,1/8,1/16,1/32), for strikes 100% and 140% (it works well for strike=70%)
where 32 time-steps are necessary.
<figure><img src="/post/heston_dvss2.png"/><figcaption>
            <h4>Forward start Call price with different discretization schemes.</h4>
        </figcaption>
</figure>
</p>
<p>It would appear that the forward dynamic is sometimes poorly captured by the DVSS2 scheme.
This makes DVSS2 not competitive in practice compared to Andersen&rsquo;s QE or even Alfonsi as it can not be trusted
for a time step larger than 1/32.
Note that I insert an extra step at 7/8 for time step sizes greater or equal than 1/4: a time-step size of 1 corresponds in reality
to two time-steps respectively of size 7/8 and 1/8.</p>
<p>The error is actually because the log-asset process is sampled using a discrete random variables that matches
the first 5 moments of the normal distribution. The so-called step 5 of the algorithm specifies:
$$\hat{X} := \bar{x} + \xi \sqrt{\frac{1}{2}(\bar{y}+\hat{Y})h}$$
The notation is quite specific to the paper, what you need to know is that \(\hat{X}\) corresponds to the log-asset process
while \(\hat{Y}\) corresponds to the stochastic volatility process and \(\xi\) is the infamous discrete random variable.</p>
<p>In reality, there is no good reason to use a discrete random variable beside lowering the computational cost.
And it is obviously detrimental in the limit case where the volatility is deterministic (Black-Scholes case) as then
the log-process will only match the first 5 moments of the normal distribution, while it should be exactly normal.</p>
<p>Replacing \(\xi\) by a standard normally distributed random variable is enough to fix DVSS2. Note
that it could also be discretized like the QE scheme, using a Broadie-Kaya interpolation scheme.
<figure><img src="/post/heston_dvss2x.png"/><figcaption>
            <h4>Forward start Call price with different discretization schemes. DVSS2X denotes here the scheme with continuous normal random variable.</h4>
        </figcaption>
</figure>
</p>
<p>The problem is that then, it is not faster than QE anymore. So it is not clear why it would be preferable.</p>
<h3 id="a-discrete-distribution-matching-the-first-9-moments-of-the-normal-distribution">A discrete distribution matching the first 9 moments of the normal distribution</h3>
<p>I then tried to see if matching more moments with a discrete distribution would help. More than 8 bits
are available when generating a uniform random double precision number (as it is represented by 53 bits).
The game is then to find nodes so that the distribution with discrete probabilities in i/256 with some interger i
match the moments of the normal distribution. It is a non linear problem unfortunately, but I found a solution
for the probabilities
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#40a070">1</span><span style="color:#666">/</span><span style="color:#40a070">256</span>, <span style="color:#40a070">1</span><span style="color:#666">/</span><span style="color:#40a070">256</span>, <span style="color:#40a070">32</span><span style="color:#666">/</span><span style="color:#40a070">256</span>, <span style="color:#40a070">94</span><span style="color:#666">/</span><span style="color:#40a070">256</span>, <span style="color:#40a070">94</span><span style="color:#666">/</span><span style="color:#40a070">256</span>, <span style="color:#40a070">32</span><span style="color:#666">/</span><span style="color:#40a070">256</span>, <span style="color:#40a070">1</span><span style="color:#666">/</span><span style="color:#40a070">256</span>, <span style="color:#40a070">1</span><span style="color:#666">/</span><span style="color:#40a070">256</span></span></span></code></pre></div>
The nodes are:
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#666">-</span><span style="color:#40a070">3.1348958252117543</span>, <span style="color:#666">-</span><span style="color:#40a070">2.6510063991157273</span>, <span style="color:#666">-</span><span style="color:#40a070">1.6397086267587215</span>, <span style="color:#666">-</span><span style="color:#40a070">0.5168230803049496</span>, <span style="color:#40a070">0.5168230803049496</span>, <span style="color:#40a070">1.6397086267587215</span>, <span style="color:#40a070">2.6510063991157273</span>, <span style="color:#40a070">3.1348958252117543</span></span></span></code></pre></div>
The probabilities approximate those given by the ideal solution on 8 nodes,
that is, the weights of the Gauss-Hermite polynomial (see Alan Miller <a href="http://pubsonline.informs.org/doi/abs/10.1287/mnsc.29.3.352?journalCode=mnsc">Discrete Approximations of Probability Distributions</a>).</p>
<p>While this helps a bit for small steps as shown on the following graph, it is far from good:
<figure><img src="/post/heston_dvss2xd.png"/><figcaption>
            <h4>Forward start Call price with different discretization schemes. DVSS2X denotes here the scheme with discrete random variable matching the first 9 moments of the normal distribution.</h4>
        </figcaption>
</figure>
</p>

  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://chasethedevil.github.io/post/xfce_fedora25/">Power management and XFCE under Fedora 25</a>
  </h1>
  <time datetime="2017-01-19T09:55:32&#43;0100" class="post-date">Thu, Jan 19, 2017</time>
  <p>The gnome shell has been crashing on me more regularly lately.
XFCE is a good and fast more tradional desktop, but, from past experiences,
it does not play well with power management if you only install it via</p>
<pre tabindex="0"><code>dnf install @xfce-desktop-environment
</code></pre><p>My typical experience is a black screen after resuming from suspend (sometimes, not always), or hibernate (always) and
most of the time I end up just rebooting. It turns out this is all caused by the interaction between the gdm login daemon and xfce. Moving
to the lightdm login daemon instead fixes those issues for Fedora 25:</p>
<pre tabindex="0"><code>systemctl disable gdm
systemctl enable lightdm
systemctl stop gdm
systemctl start lightdm
</code></pre>
  
</article>
</div>
<p style="text-align:left; width:49%; display: inline-block;"><a href="/page/4/">Previous</a></p>
<p style="text-align:right; width:50%;  display: inline-block;"><a href="/page/6/">Next</a></p>
    </main>

    
      
    
  </body>
</html>
